(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{4472:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>eR});var n=a(5853),l=a(2115),r=a(7225),i=a(9434);let s=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.Y)("div",{ref:t,className:(0,i.cn)("rounded-xl border bg-card text-card-foreground shadow",a),...l})});s.displayName="Card";let d=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.Y)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",a),...l})});d.displayName="CardHeader";let c=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.Y)("div",{ref:t,className:(0,i.cn)("font-semibold leading-none tracking-tight",a),...l})});c.displayName="CardTitle",l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.Y)("div",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",a),...l})}).displayName="CardDescription";let m=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.Y)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",a),...l})});m.displayName="CardContent",l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.Y)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",a),...l})}).displayName="CardFooter";var o=a(9708),h=a(2085);let u=(0,h.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),g=l.forwardRef((e,t)=>{let{className:a,variant:l,size:r,asChild:s=!1,...d}=e,c=s?o.DX:"button";return(0,n.Y)(c,{className:(0,i.cn)(u({variant:l,size:r,className:a})),ref:t,...d})});g.displayName="Button";let p=(0,h.F)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function f(e){let{className:t,variant:a,...l}=e;return(0,n.Y)("div",{className:(0,i.cn)(p({variant:a}),t),...l})}let x=l.forwardRef((e,t)=>{let{className:a,type:l,...r}=e;return(0,n.Y)("input",{type:l,className:(0,i.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...r})});x.displayName="Input";var v=a(3651),N=a(5318);let Y=v.bL,b=v.l9,D=v.ZL;v.bm;let F=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.Y)(v.hJ,{ref:t,className:(0,i.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...l})});F.displayName=v.hJ.displayName;let y=l.forwardRef((e,t)=>{let{className:a,children:l,...r}=e;return(0,n.FD)(D,{children:[(0,n.Y)(F,{}),(0,n.FD)(v.UC,{ref:t,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...r,children:[l,(0,n.FD)(v.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,n.Y)(N.A,{className:"h-4 w-4"}),(0,n.Y)("span",{className:"sr-only",children:"Close"})]})]})]})});y.displayName=v.UC.displayName;let w=e=>{let{className:t,...a}=e;return(0,n.Y)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};w.displayName="DialogHeader";let S=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.Y)(v.hE,{ref:t,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",a),...l})});S.displayName=v.hE.displayName,l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.Y)(v.VY,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",a),...l})}).displayName=v.VY.displayName;let C=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.Y)("textarea",{className:(0,i.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...l})});C.displayName="Textarea";var A=a(968);let T=(0,h.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),R=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.Y)(A.b,{ref:t,className:(0,i.cn)(T(),a),...l})});R.displayName=A.b.displayName;var k=a(8763);function P(e){let{item:t}=e,{updateItem:a}=(0,r.d)(),[i,s]=(0,l.useState)(!1),[d,c]=(0,l.useState)({title:t.title,description:t.description,imageUrl:t.imageUrl,startingPrice:t.startingPrice,incrementStep:t.incrementStep,startTime:"",endTime:"",donor:t.donor||"",category:t.category});(0,l.useEffect)(()=>{let e=e=>{let t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0"),l=String(e.getHours()).padStart(2,"0"),r=String(e.getMinutes()).padStart(2,"0");return"".concat(t,"-").concat(a,"-").concat(n,"T").concat(l,":").concat(r)};c(a=>({...a,startTime:e(t.startTime),endTime:e(t.endTime)}))},[t]);let m=(e,t)=>{c(a=>({...a,[e]:t}))};return(0,n.FD)(Y,{open:i,onOpenChange:s,children:[(0,n.Y)(b,{asChild:!0,children:(0,n.FD)(g,{variant:"outline",size:"sm",children:[(0,n.Y)(k.A,{className:"h-4 w-4 mr-1"}),"编辑"]})}),(0,n.FD)(y,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,n.Y)(w,{children:(0,n.FD)(S,{children:["编辑拍品 - ",t.title]})}),(0,n.FD)("form",{onSubmit:e=>{if(e.preventDefault(),!d.title||!d.description||!d.imageUrl)return void alert("请填写所有必填字段");a({...t,title:d.title,description:d.description,imageUrl:d.imageUrl,startingPrice:d.startingPrice,incrementStep:d.incrementStep,startTime:new Date(d.startTime),endTime:new Date(d.endTime),donor:d.donor,category:d.category}),s(!1)},className:"space-y-4",children:[(0,n.FD)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.FD)("div",{children:[(0,n.Y)(R,{htmlFor:"edit-title",children:"拍品名称 *"}),(0,n.Y)(x,{id:"edit-title",value:d.title,onChange:e=>m("title",e.target.value),placeholder:"请输入拍品名称",required:!0})]}),(0,n.FD)("div",{children:[(0,n.Y)(R,{htmlFor:"edit-category",children:"类别"}),(0,n.Y)(x,{id:"edit-category",value:d.category,onChange:e=>m("category",e.target.value),placeholder:"如：艺术品、古董等"})]})]}),(0,n.FD)("div",{children:[(0,n.Y)(R,{htmlFor:"edit-description",children:"描述 *"}),(0,n.Y)(C,{id:"edit-description",value:d.description,onChange:e=>m("description",e.target.value),placeholder:"请详细描述拍品信息",rows:3,required:!0})]}),(0,n.FD)("div",{children:[(0,n.Y)(R,{htmlFor:"edit-imageUrl",children:"图片链接 *"}),(0,n.Y)(x,{id:"edit-imageUrl",value:d.imageUrl,onChange:e=>m("imageUrl",e.target.value),placeholder:"请输入图片URL",required:!0}),(0,n.Y)("p",{className:"text-xs text-muted-foreground mt-1",children:"可以使用 Unsplash 等免费图片服务的链接"})]}),(0,n.FD)("div",{children:[(0,n.Y)(R,{htmlFor:"edit-donor",children:"捐赠者"}),(0,n.Y)(x,{id:"edit-donor",value:d.donor,onChange:e=>m("donor",e.target.value),placeholder:"捐赠者姓名"})]}),(0,n.FD)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.FD)("div",{children:[(0,n.Y)(R,{htmlFor:"edit-startingPrice",children:"起拍价 (元)"}),(0,n.Y)(x,{id:"edit-startingPrice",type:"number",value:d.startingPrice,onChange:e=>m("startingPrice",Number(e.target.value)),min:"1",disabled:t.bids.length>0}),t.bids.length>0&&(0,n.Y)("p",{className:"text-xs text-yellow-600 mt-1",children:"已有竞拍记录，无法修改起拍价"})]}),(0,n.FD)("div",{children:[(0,n.Y)(R,{htmlFor:"edit-incrementStep",children:"最小加价 (元)"}),(0,n.Y)(x,{id:"edit-incrementStep",type:"number",value:d.incrementStep,onChange:e=>m("incrementStep",Number(e.target.value)),min:"1"})]})]}),(0,n.FD)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.FD)("div",{children:[(0,n.Y)(R,{htmlFor:"edit-startTime",children:"开始时间"}),(0,n.Y)(x,{id:"edit-startTime",type:"datetime-local",value:d.startTime,onChange:e=>m("startTime",e.target.value),disabled:"active"===t.status||"ended"===t.status}),("active"===t.status||"ended"===t.status)&&(0,n.Y)("p",{className:"text-xs text-yellow-600 mt-1",children:"拍卖已开始，无法修改开始时间"})]}),(0,n.FD)("div",{children:[(0,n.Y)(R,{htmlFor:"edit-endTime",children:"结束时间"}),(0,n.Y)(x,{id:"edit-endTime",type:"datetime-local",value:d.endTime,onChange:e=>m("endTime",e.target.value),disabled:"ended"===t.status}),"ended"===t.status&&(0,n.Y)("p",{className:"text-xs text-yellow-600 mt-1",children:"拍卖已结束，无法修改结束时间"})]})]}),(0,n.FD)("div",{className:"flex gap-2 pt-4",children:[(0,n.Y)(g,{type:"submit",className:"flex-1",children:"保存修改"}),(0,n.Y)(g,{type:"button",variant:"outline",onClick:()=>s(!1),children:"取消"})]})]})]})]})}var z=a(8880);let U=z.bL,E=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.Y)(z.B8,{ref:t,className:(0,i.cn)("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",a),...l})});E.displayName=z.B8.displayName;let j=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.Y)(z.l9,{ref:t,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",a),...l})});j.displayName=z.l9.displayName;let I=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.Y)(z.UC,{ref:t,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...l})});I.displayName=z.UC.displayName;var O=a(2160),L=a(1721),q=a(9637),_=a(1554),M=a(6950),B=a(3662),V=a(5300);function K(e){let{isOpen:t,onClose:a,onSubmit:r,initialData:i={},itemTitle:s,amount:d}=e,[c,m]=(0,l.useState)({name:i.name||"",email:i.email||"",phone:i.phone||"",address:i.address||"",organization:i.organization||"",notes:i.notes||""}),[o,h]=(0,l.useState)({}),u=()=>{let e={};return c.name.trim()||(e.name="请输入您的姓名"),c.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(c.email)||(e.email="请输入有效的邮箱地址"):e.email="请输入您的邮箱",h(e),0===Object.keys(e).length},p=(e,t)=>{m(a=>({...a,[e]:t})),o[e]&&h(t=>({...t,[e]:void 0}))};return(0,n.Y)(Y,{open:t,onOpenChange:a,children:(0,n.FD)(y,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,n.FD)(w,{children:[(0,n.FD)(S,{className:"flex items-center gap-2",children:[(0,n.Y)(O.A,{className:"h-5 w-5 text-orange-600"}),"完善个人信息 - 申请捐赠证明"]}),(0,n.FD)("div",{className:"text-sm text-muted-foreground",children:["拍品：",s," | 金额：\xa5",d]})]}),(0,n.FD)("div",{className:"space-y-6",children:[(0,n.FD)("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:[(0,n.Y)("h3",{className:"font-medium text-orange-900 mb-2",children:"为什么需要填写个人信息？"}),(0,n.FD)("ul",{className:"text-sm text-orange-800 space-y-1",children:[(0,n.Y)("li",{children:"• 财务人员将为您准备正式的捐赠证明"}),(0,n.Y)("li",{children:"• 捐赠证明可用于个人或企业的税务减免"}),(0,n.Y)("li",{children:"• 我们会保护您的隐私，信息仅用于捐赠证明和后续联系"}),(0,n.Y)("li",{children:'• 标注"*"的为必填项，其他为选填项'})]})]}),(0,n.FD)("form",{onSubmit:e=>{e.preventDefault(),u()&&(r(c),a())},className:"space-y-4",children:[(0,n.FD)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,n.FD)("div",{children:[(0,n.FD)(R,{htmlFor:"name",className:"flex items-center gap-2",children:[(0,n.Y)(L.A,{className:"h-4 w-4"}),"姓名 *"]}),(0,n.Y)(x,{id:"name",value:c.name,onChange:e=>p("name",e.target.value),placeholder:"请输入您的真实姓名",className:o.name?"border-red-500":""}),o.name&&(0,n.Y)("p",{className:"text-sm text-red-500 mt-1",children:o.name})]}),(0,n.FD)("div",{children:[(0,n.FD)(R,{htmlFor:"email",className:"flex items-center gap-2",children:[(0,n.Y)(q.A,{className:"h-4 w-4"}),"邮箱 *"]}),(0,n.Y)(x,{id:"email",type:"email",value:c.email,onChange:e=>p("email",e.target.value),placeholder:"用于接收捐赠证明",className:o.email?"border-red-500":""}),o.email&&(0,n.Y)("p",{className:"text-sm text-red-500 mt-1",children:o.email})]})]}),(0,n.FD)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,n.FD)("div",{children:[(0,n.FD)(R,{htmlFor:"phone",className:"flex items-center gap-2",children:[(0,n.Y)(_.A,{className:"h-4 w-4"}),"联系电话"]}),(0,n.Y)(x,{id:"phone",value:c.phone,onChange:e=>p("phone",e.target.value),placeholder:"方便后续联系"})]}),(0,n.FD)("div",{children:[(0,n.FD)(R,{htmlFor:"organization",className:"flex items-center gap-2",children:[(0,n.Y)(M.A,{className:"h-4 w-4"}),"所属机构/公司"]}),(0,n.Y)(x,{id:"organization",value:c.organization,onChange:e=>p("organization",e.target.value),placeholder:"如需开具企业捐赠证明请填写"})]})]}),(0,n.FD)("div",{children:[(0,n.FD)(R,{htmlFor:"address",className:"flex items-center gap-2",children:[(0,n.Y)(B.A,{className:"h-4 w-4"}),"通讯地址"]}),(0,n.Y)(x,{id:"address",value:c.address,onChange:e=>p("address",e.target.value),placeholder:"如需邮寄纸质证明请填写详细地址"})]}),(0,n.FD)("div",{children:[(0,n.FD)(R,{htmlFor:"notes",className:"flex items-center gap-2",children:[(0,n.Y)(V.A,{className:"h-4 w-4"}),"备注信息"]}),(0,n.Y)(C,{id:"notes",value:c.notes,onChange:e=>p("notes",e.target.value),placeholder:"其他需要说明的信息（如特殊要求等）",rows:3})]}),(0,n.FD)("div",{className:"flex gap-2 pt-4",children:[(0,n.Y)(g,{type:"submit",className:"flex-1",children:"确认提交信息"}),(0,n.Y)(g,{type:"button",variant:"outline",onClick:a,children:"暂不填写"})]})]}),(0,n.FD)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,n.Y)("h4",{className:"font-medium mb-2",children:"隐私保护承诺"}),(0,n.Y)("p",{className:"text-sm text-gray-600",children:"晓日春晖慈善组织承诺严格保护您的个人信息，仅用于捐赠证明制作和必要的后续联系。 我们不会将您的信息用于其他商业用途或向第三方泄露。"})]})]})]})})}var G=a(5633),H=a(6160),J=a(389),X=a(518),$=a(5599);function Q(e){let{amount:t,itemTitle:a,bidderName:i,onPaymentMethodSelected:o}=e,{paymentInfo:h}=(0,r.d)(),[u,p]=(0,l.useState)(!0),[x,v]=(0,l.useState)(""),[N,b]=(0,l.useState)(!1),[D,F]=(0,l.useState)("");(0,l.useEffect)(()=>{p(!0)},[t,a,i]);let C=async(e,t)=>{try{await navigator.clipboard.writeText(e),v(t),setTimeout(()=>v(""),2e3)}catch(e){alert("复制失败，请手动复制")}},A=e=>{switch(e){case"bank":return(0,n.Y)(M.A,{className:"h-5 w-5"});case"alipay":case"wechat":return(0,n.Y)(G.A,{className:"h-5 w-5"});default:return(0,n.Y)(H.A,{className:"h-5 w-5"})}},T=e=>{F(e),p(!1),setTimeout(()=>{b(!0)},100)},R=h.methods.filter(e=>e.isActive),k=R.filter(e=>"bank"===e.type),P=R.filter(e=>"alipay"===e.type||"wechat"===e.type);return(0,n.FD)(n.FK,{children:[(0,n.Y)(Y,{open:u,onOpenChange:p,children:(0,n.FD)(y,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,n.FD)(w,{children:[(0,n.Y)(S,{children:"选择付款方式"}),(0,n.FD)("div",{className:"text-sm text-muted-foreground",children:["拍品：",a," | 竞拍者：",i," |",(0,n.FD)("span",{className:"font-bold text-green-600",children:["金额：\xa5",t]})]})]}),(0,n.FD)("div",{className:"space-y-6",children:[(0,n.FD)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,n.Y)("h3",{className:"font-medium text-blue-900 mb-2",children:"付款说明"}),(0,n.FD)("ul",{className:"text-sm text-blue-800 space-y-1",children:[(0,n.Y)("li",{children:"• 请在转账备注中注明：拍品名称 + 竞拍者姓名"}),(0,n.Y)("li",{children:"• 付款后请保留转账凭证，并联系工作人员确认"}),(0,n.Y)("li",{children:"• 完成付款后会要求填写个人信息，用于制作捐赠证明"}),(0,n.FD)("li",{children:["• 如有疑问，请联系客服：",h.organizer.phone]})]})]}),(0,n.FD)(U,{defaultValue:k.length>0?"bank":"mobile",className:"w-full",children:[(0,n.FD)(E,{className:"grid w-full grid-cols-2",children:[k.length>0&&(0,n.FD)(j,{value:"bank",className:"flex items-center gap-2",children:[(0,n.Y)(M.A,{className:"h-4 w-4"}),"银行转账 (",k.length,")"]}),P.length>0&&(0,n.FD)(j,{value:"mobile",className:"flex items-center gap-2",children:[(0,n.Y)(J.A,{className:"h-4 w-4"}),"扫码支付 (",P.length,")"]})]}),k.length>0&&(0,n.Y)(I,{value:"bank",className:"mt-6",children:(0,n.Y)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:k.map(e=>(0,n.FD)(s,{className:"transition-all hover:shadow-md",children:[(0,n.Y)(d,{className:"pb-3",children:(0,n.FD)(c,{className:"flex items-center gap-2 text-lg",children:[A(e.type),e.name]})}),(0,n.FD)(m,{className:"space-y-3",children:[e.account&&(0,n.Y)("div",{className:"bg-gray-50 p-3 rounded-lg",children:(0,n.FD)("div",{className:"flex items-center justify-between",children:[(0,n.Y)("span",{className:"text-sm text-gray-600",children:"账号："}),(0,n.FD)("div",{className:"flex items-center gap-2",children:[(0,n.Y)("span",{className:"font-mono font-medium",children:e.account}),(0,n.Y)(g,{variant:"ghost",size:"sm",onClick:()=>C(e.account,"account-".concat(e.id)),className:"h-6 w-6 p-0",children:x==="account-".concat(e.id)?(0,n.Y)(X.A,{className:"h-3 w-3"}):(0,n.Y)($.A,{className:"h-3 w-3"})})]})]})}),(0,n.FD)("div",{className:"bg-gray-50 p-3 rounded-lg",children:[(0,n.FD)("div",{className:"flex items-center justify-between mb-2",children:[(0,n.Y)("span",{className:"text-sm text-gray-600",children:"转账备注："}),(0,n.Y)(g,{variant:"ghost",size:"sm",onClick:()=>C("".concat(a,"-").concat(i),"memo-".concat(e.id)),className:"h-6 w-6 p-0",children:x==="memo-".concat(e.id)?(0,n.Y)(X.A,{className:"h-3 w-3"}):(0,n.Y)($.A,{className:"h-3 w-3"})})]}),(0,n.FD)("span",{className:"font-medium",children:[a,"-",i]})]}),(0,n.Y)("p",{className:"text-xs text-gray-600",children:e.instructions}),(0,n.Y)(g,{onClick:()=>T(e.id),className:"w-full",variant:"outline",children:"选择此方式"})]})]},e.id))})}),P.length>0&&(0,n.Y)(I,{value:"mobile",className:"mt-6",children:(0,n.Y)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:P.map(e=>(0,n.FD)(s,{className:"transition-all hover:shadow-md",children:[(0,n.Y)(d,{className:"pb-3",children:(0,n.FD)(c,{className:"flex items-center gap-2 text-lg",children:[A(e.type),e.name,(0,n.Y)(f,{variant:"alipay"===e.type?"default":"secondary",children:"alipay"===e.type?"支付宝":"微信"})]})}),(0,n.FD)(m,{className:"space-y-4",children:[e.qrCodeUrl&&(0,n.Y)("div",{className:"flex justify-center",children:(0,n.Y)("div",{className:"border-2 border-gray-200 rounded-lg p-4",children:(0,n.Y)("img",{src:e.qrCodeUrl,alt:"".concat(e.name,"二维码"),className:"w-48 h-48 object-cover"})})}),e.account&&(0,n.Y)("div",{className:"bg-gray-50 p-3 rounded-lg",children:(0,n.FD)("div",{className:"flex items-center justify-between",children:[(0,n.Y)("span",{className:"text-sm text-gray-600",children:"账号："}),(0,n.FD)("div",{className:"flex items-center gap-2",children:[(0,n.Y)("span",{className:"font-medium",children:e.account}),(0,n.Y)(g,{variant:"ghost",size:"sm",onClick:()=>C(e.account,"mobile-account-".concat(e.id)),className:"h-6 w-6 p-0",children:x==="mobile-account-".concat(e.id)?(0,n.Y)(X.A,{className:"h-3 w-3"}):(0,n.Y)($.A,{className:"h-3 w-3"})})]})]})}),(0,n.Y)("p",{className:"text-xs text-gray-600 text-center",children:e.instructions}),(0,n.Y)(g,{onClick:()=>T(e.id),className:"w-full",children:"完成支付"})]})]},e.id))})})]}),(0,n.FD)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,n.Y)("h3",{className:"font-medium mb-2",children:"联系我们"}),(0,n.FD)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[(0,n.FD)("div",{children:[(0,n.Y)("span",{className:"text-gray-600",children:"组织方："}),(0,n.Y)("span",{className:"font-medium",children:h.organizer.name})]}),(0,n.FD)("div",{children:[(0,n.Y)("span",{className:"text-gray-600",children:"电话："}),(0,n.Y)("span",{className:"font-medium",children:h.organizer.phone})]}),(0,n.FD)("div",{children:[(0,n.Y)("span",{className:"text-gray-600",children:"邮箱："}),(0,n.Y)("span",{className:"font-medium",children:h.organizer.email})]})]})]}),(0,n.Y)("div",{className:"flex gap-2",children:(0,n.Y)(g,{variant:"outline",onClick:()=>{p(!1)},className:"flex-1",children:"取消支付"})})]})]})}),(0,n.Y)(K,{isOpen:N,onClose:()=>b(!1),onSubmit:e=>{o(D,e),b(!1)},itemTitle:a,amount:t,initialData:{name:i}})]})}var Z=a(8611);let W=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,n.Y)(Z.bL,{className:(0,i.cn)("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",a),...l,ref:t,children:(0,n.Y)(Z.zi,{className:(0,i.cn)("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})})});W.displayName=Z.bL.displayName;var ee=a(8531),et=a(7648);function ea(e){let{item:t}=e,{updateItem:a}=(0,r.d)(),[i,o]=(0,l.useState)(!1),[h,u]=(0,l.useState)(t.roundSettings),p=(e,t,a)=>{let n=[];for(let l=0;l<t;l++){let t=new Date(e.getTime()+(l+1)*a*6e4);n.push(t)}return n},v=e=>{let a=new Date;return e>t.roundSettings.currentRound?"upcoming":a>t.roundSettings.roundEndTimes[e-1]?"completed":a>=(1===e?t.startTime:t.roundSettings.roundEndTimes[e-2])?"active":"upcoming"},N=e=>new Intl.DateTimeFormat("zh-CN",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(e),D=e=>{switch(e){case"active":return"bg-green-500";case"upcoming":return"bg-blue-500";default:return"bg-gray-500"}},F=e=>{switch(e){case"active":return"进行中";case"upcoming":return"未开始";case"completed":return"已结束";default:return"未知"}},C=(()=>{if(!t.roundSettings.enabled||0===t.roundSettings.currentRound)return null;let e=t.roundSettings.currentRound,a=new Date,n=1===e?t.startTime:t.roundSettings.roundEndTimes[e-2],l=t.roundSettings.roundEndTimes[e-1];return{round:e,startTime:n,endTime:l,isActive:a>=n&&a<=l,isCompleted:a>l,highestBid:t.bids.filter(t=>t.round===e).sort((e,t)=>t.amount-e.amount)[0]}})();return(0,n.FD)(Y,{open:i,onOpenChange:o,children:[(0,n.Y)(b,{asChild:!0,children:(0,n.FD)(g,{variant:"outline",size:"sm",children:[(0,n.Y)(ee.A,{className:"h-4 w-4 mr-1"}),"轮次设置"]})}),(0,n.FD)(y,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[(0,n.Y)(w,{children:(0,n.FD)(S,{children:["多轮竞拍设置 - ",t.title]})}),(0,n.FD)("div",{className:"space-y-6",children:[t.roundSettings.enabled&&(0,n.FD)(s,{children:[(0,n.Y)(d,{children:(0,n.FD)(c,{className:"flex items-center gap-2",children:[(0,n.Y)(et.A,{className:"h-5 w-5"}),"当前竞拍状态"]})}),(0,n.Y)(m,{children:C?(0,n.FD)("div",{className:"space-y-3",children:[(0,n.FD)("div",{className:"flex items-center justify-between",children:[(0,n.FD)("span",{className:"font-medium",children:["第 ",C.round," 轮"]}),(0,n.Y)(f,{className:D(C.isActive?"active":C.isCompleted?"completed":"upcoming"),children:F(C.isActive?"active":C.isCompleted?"completed":"upcoming")})]}),(0,n.FD)("div",{className:"text-sm text-gray-600",children:[(0,n.FD)("div",{children:["开始时间：",N(C.startTime)]}),(0,n.FD)("div",{children:["结束时间：",N(C.endTime)]})]}),C.highestBid&&(0,n.FD)("div",{className:"bg-green-50 p-3 rounded-lg",children:[(0,n.Y)("div",{className:"text-sm",children:"本轮最高出价："}),(0,n.FD)("div",{className:"font-bold text-green-600",children:["\xa5",C.highestBid.amount," - ",C.highestBid.bidderName]})]})]}):(0,n.Y)("div",{className:"text-gray-500",children:"竞拍尚未开始"})})]}),(0,n.FD)(s,{children:[(0,n.Y)(d,{children:(0,n.Y)(c,{children:"基本设置"})}),(0,n.FD)(m,{className:"space-y-4",children:[(0,n.FD)("div",{className:"flex items-center justify-between",children:[(0,n.FD)("div",{children:[(0,n.Y)(R,{htmlFor:"enable-rounds",children:"启用多轮竞拍"}),(0,n.Y)("p",{className:"text-sm text-gray-600",children:"开启后将分轮次进行竞拍"})]}),(0,n.Y)(W,{id:"enable-rounds",checked:h.enabled,onCheckedChange:e=>u({...h,enabled:e})})]}),h.enabled&&(0,n.FD)(n.FK,{children:[(0,n.FD)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.FD)("div",{children:[(0,n.Y)(R,{htmlFor:"total-rounds",children:"竞拍轮数"}),(0,n.Y)(x,{id:"total-rounds",type:"number",min:"2",max:"5",value:h.totalRounds,onChange:e=>u({...h,totalRounds:Number(e.target.value)})}),(0,n.Y)("p",{className:"text-xs text-gray-600 mt-1",children:"建议2-3轮"})]}),(0,n.FD)("div",{children:[(0,n.Y)(R,{htmlFor:"round-duration",children:"每轮时长（分钟）"}),(0,n.Y)(x,{id:"round-duration",type:"number",min:"5",max:"120",value:h.roundDuration,onChange:e=>u({...h,roundDuration:Number(e.target.value)})}),(0,n.Y)("p",{className:"text-xs text-gray-600 mt-1",children:"建议15-30分钟"})]})]}),(0,n.FD)("div",{children:[(0,n.Y)(R,{children:"轮次时间预览"}),(0,n.Y)("div",{className:"space-y-2 mt-2",children:Array.from({length:h.totalRounds},(e,a)=>{let l=a+1,r=0===a?t.startTime:new Date(t.startTime.getTime()+a*h.roundDuration*6e4),i=new Date(t.startTime.getTime()+l*h.roundDuration*6e4),s=v(l);return(0,n.FD)("div",{className:"flex items-center justify-between p-2 border rounded",children:[(0,n.FD)("div",{className:"flex items-center gap-2",children:[(0,n.FD)(f,{variant:"outline",children:["第 ",l," 轮"]}),(0,n.FD)("span",{className:"text-sm",children:[N(r)," - ",N(i)]})]}),(0,n.Y)(f,{className:D(s),children:F(s)})]},l)})})]})]})]})]}),(0,n.FD)(s,{children:[(0,n.Y)(d,{children:(0,n.Y)(c,{children:"竞拍规则"})}),(0,n.Y)(m,{children:(0,n.FD)("ul",{className:"text-sm space-y-2 text-gray-600",children:[(0,n.Y)("li",{children:"• 每轮竞拍有固定的时间限制"}),(0,n.Y)("li",{children:"• 每轮结束时的最高出价者可进入下一轮"}),(0,n.Y)("li",{children:"• 最后一轮结束时的最高出价者获得拍品"}),(0,n.Y)("li",{children:"• 如果某轮无人出价，拍卖可能提前结束"}),(0,n.Y)("li",{children:"• 管理员可以随时调整设置（竞拍开始前）"})]})})]}),(0,n.FD)("div",{className:"flex gap-2",children:[(0,n.Y)(g,{onClick:()=>{let e=h.enabled?p(t.startTime,h.totalRounds,h.roundDuration):[],n={...h,roundEndTimes:e,currentRound:+!!h.enabled};a({...t,roundSettings:n}),o(!1),alert("多轮竞拍设置已保存")},className:"flex-1",children:"保存设置"}),(0,n.Y)(g,{variant:"outline",onClick:()=>o(!1),className:"flex-1",children:"取消"})]})]})]})]})}var en=a(7223),el=a(3054),er=a(9099);function ei(e){let{item:t,isAdmin:a=!1}=e,{placeBid:i,deleteItem:o,getRoundTimeRemaining:h}=(0,r.d)(),[u,p]=(0,l.useState)(t.currentPrice+t.incrementStep),[v,N]=(0,l.useState)(""),[D,F]=(0,l.useState)(!1),[C,A]=(0,l.useState)(!1),[T,R]=(0,l.useState)(null),[k,z]=(0,l.useState)(0);(0,l.useEffect)(()=>{A(!0)},[]),(0,l.useEffect)(()=>{p(t.currentPrice+t.incrementStep)},[t.currentPrice,t.incrementStep]),(0,l.useEffect)(()=>{if(!t.roundSettings.enabled)return;let e=()=>{z(h(t.id))};e();let a=setInterval(e,1e3);return()=>clearInterval(a)},[t.id,t.roundSettings,h]);let U=e=>C?new Intl.DateTimeFormat("zh-CN",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(e):"",E=e=>{if(e<=0)return"已结束";let t=Math.floor(e/6e4),a=Math.floor(e%6e4/1e3);return t>0?"".concat(t,"分").concat(a,"秒"):"".concat(a,"秒")},j=(()=>{if(!t.roundSettings.enabled)return t.bids.length>0?t.bids[t.bids.length-1]:null;let e=t.bids.filter(e=>e.round===t.roundSettings.currentRound);return e.length>0?e.sort((e,t)=>t.amount-e.amount)[0]:null})();return(0,n.FD)(s,{className:"overflow-hidden transition-all hover:shadow-lg sm:hover:shadow-lg",children:[(0,n.FD)("div",{className:"relative",children:[(0,n.Y)("img",{src:t.imageUrl,alt:t.title,className:"w-full h-36 sm:h-48 object-cover",onError:e=>{e.target.src="https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=800&h=600&fit=crop"}}),(0,n.Y)(f,{className:"absolute top-2 right-2 ".concat((e=>{switch(e){case"active":return"bg-green-500";case"upcoming":return"bg-blue-500";default:return"bg-gray-500"}})(t.status)," text-white"),children:(e=>{switch(e){case"active":return"进行中";case"upcoming":return"即将开始";case"ended":return"已结束";default:return"未知"}})(t.status)}),a&&(0,n.Y)("div",{className:"absolute top-2 left-2 flex gap-1",children:(0,n.Y)(g,{variant:"destructive",size:"sm",onClick:()=>{confirm("确定要删除这个拍品吗？")&&o(t.id)},children:(0,n.Y)(en.A,{className:"h-4 w-4"})})})]}),(0,n.FD)(d,{className:"pb-3 sm:pb-6",children:[(0,n.Y)(c,{className:"text-base sm:text-lg leading-tight",children:t.title}),(0,n.FD)("div",{className:"flex items-center gap-2 text-xs sm:text-sm text-muted-foreground",children:[(0,n.Y)(el.A,{className:"h-3 w-3 sm:h-4 sm:w-4"}),(0,n.Y)("span",{children:t.category})]})]}),(0,n.FD)(m,{className:"space-y-2 sm:space-y-3 p-3 sm:p-6",children:[(0,n.Y)("p",{className:"text-xs sm:text-sm text-muted-foreground line-clamp-2",children:t.description}),t.donor&&(0,n.FD)("div",{className:"flex items-center gap-2 text-xs sm:text-sm",children:[(0,n.Y)(L.A,{className:"h-3 w-3 sm:h-4 sm:w-4"}),(0,n.FD)("span",{children:["捐赠者：",t.donor]})]}),t.roundSettings.enabled&&(0,n.FD)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-2 sm:p-3",children:[(0,n.FD)("div",{className:"flex items-center justify-between mb-1 sm:mb-2",children:[(0,n.FD)("div",{className:"flex items-center gap-1 sm:gap-2",children:[(0,n.Y)(ee.A,{className:"h-3 w-3 sm:h-4 sm:w-4 text-blue-600"}),(0,n.Y)("span",{className:"text-xs sm:text-sm font-medium text-blue-900",children:"多轮竞拍"})]}),(0,n.FD)(f,{variant:"outline",className:"text-xs sm:text-sm text-blue-700 border-blue-300 px-1 sm:px-2",children:["第 ",t.roundSettings.currentRound," / ",t.roundSettings.totalRounds," 轮"]})]}),"active"===t.status&&k>0&&(0,n.FD)("div",{className:"flex items-center gap-1 sm:gap-2 text-xs sm:text-sm text-blue-700",children:[(0,n.Y)(er.A,{className:"h-3 w-3"}),(0,n.FD)("span",{children:["本轮剩余：",E(k)]})]})]}),(0,n.FD)("div",{className:"space-y-1 sm:space-y-2",children:[(0,n.FD)("div",{className:"flex justify-between items-center",children:[(0,n.Y)("span",{className:"text-xs sm:text-sm text-gray-600",children:"起拍价："}),(0,n.FD)("span",{className:"text-sm sm:text-base font-medium",children:["\xa5",t.startingPrice]})]}),(0,n.FD)("div",{className:"flex justify-between items-center",children:[(0,n.Y)("span",{className:"text-xs sm:text-sm text-gray-600",children:"当前价："}),(0,n.FD)("span",{className:"font-bold text-base sm:text-lg text-green-600",children:["\xa5",t.currentPrice]})]}),(0,n.FD)("div",{className:"flex justify-between items-center text-xs sm:text-sm text-muted-foreground",children:[(0,n.Y)("span",{children:"最小加价："}),(0,n.FD)("span",{children:["\xa5",t.incrementStep]})]})]}),C&&!t.roundSettings.enabled&&(0,n.FD)("div",{className:"flex items-center gap-1 sm:gap-2 text-xs sm:text-sm text-muted-foreground",children:[(0,n.Y)(et.A,{className:"h-3 w-3 sm:h-4 sm:w-4"}),(0,n.Y)("span",{className:"truncate",children:"upcoming"===t.status?"开始：".concat(U(t.startTime)):"结束：".concat(U(t.endTime))})]}),j&&(0,n.Y)("div",{className:"text-xs text-muted-foreground bg-gray-50 p-2 rounded",children:(0,n.FD)("div",{className:"flex items-center justify-between",children:[(0,n.FD)("span",{className:"truncate",children:[t.roundSettings.enabled?"本轮":"最新","出价：",j.bidderName]}),(0,n.FD)("div",{className:"flex items-center gap-1",children:[(0,n.FD)("span",{className:"font-medium",children:["\xa5",j.amount]}),"pending"===j.paymentStatus&&(0,n.Y)(f,{variant:"outline",className:"text-xs px-1",children:"待付款"})]})]})}),(0,n.FD)("div",{className:"flex flex-col sm:flex-row gap-2 mt-3 sm:mt-4",children:[a&&(0,n.FD)("div",{className:"flex gap-2 mb-2 sm:mb-0",children:[(0,n.Y)(P,{item:t}),(0,n.Y)(ea,{item:t})]}),"active"===t.status&&(!t.roundSettings.enabled||k>0)&&(0,n.FD)(Y,{open:D,onOpenChange:F,children:[(0,n.Y)(b,{asChild:!0,children:(0,n.Y)(g,{className:"w-full sm:flex-1 min-h-[44px]",children:"立即竞拍"})}),(0,n.FD)(y,{className:"sm:max-w-md mx-auto",children:[(0,n.Y)(w,{children:(0,n.FD)(S,{className:"text-base sm:text-lg",children:["竞拍 - ",t.title,t.roundSettings.enabled&&(0,n.FD)("span",{className:"text-xs sm:text-sm font-normal text-blue-600 block sm:inline sm:ml-2",children:["(第 ",t.roundSettings.currentRound," 轮)"]})]})}),(0,n.FD)("div",{className:"space-y-3 sm:space-y-4",children:[t.roundSettings.enabled&&(0,n.Y)("div",{className:"bg-blue-50 p-2 sm:p-3 rounded-lg",children:(0,n.FD)("div",{className:"text-xs sm:text-sm text-blue-700",children:["本轮剩余时间：",E(k)]})}),(0,n.FD)("div",{children:[(0,n.Y)("label",{className:"text-xs sm:text-sm font-medium",children:"当前价格"}),(0,n.FD)("p",{className:"text-xl sm:text-2xl font-bold text-green-600",children:["\xa5",t.currentPrice]})]}),(0,n.FD)("div",{children:[(0,n.Y)("label",{className:"text-xs sm:text-sm font-medium",children:"您的姓名"}),(0,n.Y)(x,{value:v,onChange:e=>N(e.target.value),placeholder:"请输入您的姓名",className:"mt-1"})]}),(0,n.FD)("div",{children:[(0,n.Y)("label",{className:"text-xs sm:text-sm font-medium",children:"出价金额"}),(0,n.Y)(x,{type:"number",value:u,onChange:e=>p(Number(e.target.value)),min:t.currentPrice+t.incrementStep,step:t.incrementStep,className:"mt-1"}),(0,n.FD)("p",{className:"text-xs text-muted-foreground mt-1",children:["最低出价：\xa5",t.currentPrice+t.incrementStep]})]}),(0,n.Y)(g,{onClick:()=>v.trim()?u<t.currentPrice+t.incrementStep?void alert("出价不能低于 \xa5".concat(t.currentPrice+t.incrementStep)):t.roundSettings.enabled&&k<=0?void alert("当前轮次已结束，请等待下一轮开始"):void(i(t.id,v,u,"",void 0)?(N(""),p(t.currentPrice+t.incrementStep),F(!1),alert("竞拍成功！请等待拍卖结束后进行付款。")):alert("竞拍失败，请重试")):void alert("请输入竞拍者姓名"),className:"w-full min-h-[44px]",children:"确认出价"})]})]})]}),"ended"===t.status&&j&&!j.paymentStatus&&(0,n.FD)("div",{className:"mt-3 sm:mt-4 p-3 sm:p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[(0,n.FD)("div",{className:"text-center mb-3",children:[(0,n.Y)("p",{className:"text-sm sm:text-base font-medium text-yellow-800",children:"\uD83C\uDF89 拍卖已结束！"}),(0,n.FD)("div",{className:"mt-2 space-y-1",children:[(0,n.FD)("p",{className:"text-xs sm:text-sm text-yellow-700",children:["中标价格：\xa5",null==j?void 0:j.amount]}),(0,n.FD)("p",{className:"text-xs sm:text-sm text-yellow-700",children:["中标者：",null==j?void 0:j.bidderName]})]})]}),(0,n.Y)(g,{onClick:()=>{let e=prompt("请输入您的姓名以确认身份：");e&&e.trim()===(null==j?void 0:j.bidderName)?R({amount:j.amount,bidder:j.bidderName}):e&&alert("姓名不匹配，请确认您是中标者")},className:"w-full min-h-[44px] bg-green-600 hover:bg-green-700 text-sm sm:text-base",children:"我是中标者，立即付款"})]})]}),T&&"ended"===t.status&&(0,n.Y)(Q,{amount:T.amount,itemTitle:t.title,bidderName:T.bidder,onPaymentMethodSelected:(e,a)=>{T&&"ended"===t.status&&(i(t.id,T.bidder,T.amount,e,a)?(R(null),alert("付款成功！感谢您的参与，我们将尽快为您准备捐赠证明。")):alert("付款失败，请重试"))}})]})]})}var es=a(6318),ed=a(7933),ec=a(6923),em=a(9311);function eo(e){let{value:t,onChange:a,label:r="拍品图片",accept:i="image/*"}=e,[d,c]=(0,l.useState)(t),[o,h]=(0,l.useState)(t),[u,p]=(0,l.useState)(!1),f=(0,l.useRef)(null),v=(0,l.useRef)(null),Y=e=>{if(!e)return;p(!0);let t=new FileReader;t.onload=e=>{var t;let n=null==(t=e.target)?void 0:t.result;h(n),a(n),p(!1)},t.readAsDataURL(e)},b=e=>{c(e),h(e),a(e)};return(0,n.FD)("div",{className:"space-y-4",children:[(0,n.Y)(R,{children:r}),o&&(0,n.FD)("div",{className:"relative",children:[(0,n.Y)("img",{src:o,alt:"预览",className:"w-full h-48 object-cover rounded-lg border",onError:()=>{h(""),alert("图片加载失败，请检查URL或重新上传")}}),(0,n.Y)(g,{variant:"destructive",size:"sm",className:"absolute top-2 right-2",onClick:()=>{c(""),h(""),a(""),f.current&&(f.current.value=""),v.current&&(v.current.value="")},children:(0,n.Y)(N.A,{className:"h-4 w-4"})}),(0,n.Y)("div",{className:"absolute bottom-2 left-2",children:(0,n.FD)("div",{className:"bg-green-500 text-white px-2 py-1 rounded-md flex items-center gap-1 text-xs",children:[(0,n.Y)(X.A,{className:"h-3 w-3"}),"已选择"]})})]}),(0,n.FD)(U,{defaultValue:"url",className:"w-full",children:[(0,n.FD)(E,{className:"grid w-full grid-cols-4",children:[(0,n.FD)(j,{value:"url",className:"flex items-center gap-1",children:[(0,n.Y)(es.A,{className:"h-4 w-4"}),"URL链接"]}),(0,n.FD)(j,{value:"camera",className:"flex items-center gap-1",children:[(0,n.Y)(ed.A,{className:"h-4 w-4"}),"拍照"]}),(0,n.FD)(j,{value:"upload",className:"flex items-center gap-1",children:[(0,n.Y)(ec.A,{className:"h-4 w-4"}),"上传文件"]}),(0,n.FD)(j,{value:"gallery",className:"flex items-center gap-1",children:[(0,n.Y)(em.A,{className:"h-4 w-4"}),"示例图片"]})]}),(0,n.FD)(I,{value:"url",className:"space-y-3",children:[(0,n.FD)("div",{className:"flex gap-2",children:[(0,n.Y)(x,{value:d,onChange:e=>c(e.target.value),placeholder:"请输入图片URL地址",className:"flex-1"}),(0,n.Y)(g,{onClick:()=>{d.trim()&&(a(d.trim()),h(d.trim()))},disabled:!d.trim(),children:"使用链接"})]}),(0,n.Y)("p",{className:"text-xs text-muted-foreground",children:"支持JPG、PNG、GIF等格式的图片链接，建议使用高质量图片"})]}),(0,n.FD)(I,{value:"camera",className:"space-y-3",children:[(0,n.FD)("div",{className:"text-center",children:[(0,n.Y)("input",{ref:v,type:"file",accept:i,capture:"environment",onChange:e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];a&&Y(a)},className:"hidden"}),(0,n.FD)(g,{onClick:()=>{var e;return null==(e=v.current)?void 0:e.click()},className:"w-full",disabled:u,children:[(0,n.Y)(ed.A,{className:"h-4 w-4 mr-2"}),u?"处理中...":"打开相机拍照"]})]}),(0,n.Y)("p",{className:"text-xs text-muted-foreground text-center",children:"点击按钮调用设备相机拍摄拍品照片"})]}),(0,n.FD)(I,{value:"upload",className:"space-y-3",children:[(0,n.FD)("div",{className:"text-center",children:[(0,n.Y)("input",{ref:f,type:"file",accept:i,onChange:e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];a&&Y(a)},className:"hidden"}),(0,n.FD)(g,{onClick:()=>{var e;return null==(e=f.current)?void 0:e.click()},className:"w-full",disabled:u,children:[(0,n.Y)(ec.A,{className:"h-4 w-4 mr-2"}),u?"上传中...":"选择文件上传"]})]}),(0,n.Y)("p",{className:"text-xs text-muted-foreground text-center",children:"支持从设备相册或文件管理器选择图片文件"})]}),(0,n.FD)(I,{value:"gallery",className:"space-y-3",children:[(0,n.Y)("div",{className:"grid grid-cols-2 gap-3",children:[{url:"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=800&h=600&fit=crop",title:"艺术画作"},{url:"https://images.unsplash.com/photo-1513475382585-d06e58bcb0e0?w=800&h=600&fit=crop",title:"书法作品"},{url:"https://images.unsplash.com/photo-1575389384200-b82bff6b85e4?w=800&h=600&fit=crop",title:"古董茶具"},{url:"https://images.unsplash.com/photo-1594736797933-d0fce2fe2e3d?w=800&h=600&fit=crop",title:"文物收藏"}].map((e,t)=>(0,n.Y)(s,{className:"cursor-pointer hover:shadow-md transition-all",children:(0,n.FD)(m,{className:"p-3",children:[(0,n.Y)("img",{src:e.url,alt:e.title,className:"w-full h-24 object-cover rounded mb-2"}),(0,n.FD)("div",{className:"flex items-center justify-between",children:[(0,n.Y)("span",{className:"text-xs text-muted-foreground",children:e.title}),(0,n.Y)(g,{size:"sm",variant:"outline",onClick:()=>b(e.url),children:"使用"})]})]})},t))}),(0,n.Y)("p",{className:"text-xs text-muted-foreground text-center",children:"选择示例图片作为拍品图片，您也可以替换为实际的拍品照片"})]})]})]})}var eh=a(8046);function eu(){let{addItem:e}=(0,r.d)(),[t,a]=(0,l.useState)(!1),[i,s]=(0,l.useState)({title:"",description:"",imageUrl:"",startingPrice:100,incrementStep:50,startTime:"",endTime:"",donor:"",category:""}),[d,c]=(0,l.useState)({enabled:!1,totalRounds:3,roundDuration:30}),m=t=>{if(t.preventDefault(),!i.title||!i.description||!i.imageUrl)return void alert("请填写所有必填字段");let n=new Date(i.startTime),l=new Date(i.endTime),r=(()=>{if(!d.enabled)return[];let e=[];for(let t=0;t<d.totalRounds;t++){let a=new Date(n.getTime()+(t+1)*d.roundDuration*6e4);e.push(a)}return e})();e({...i,startTime:n,endTime:l,status:"upcoming",roundSettings:{enabled:d.enabled,totalRounds:d.totalRounds,currentRound:+!d.enabled,roundDuration:d.roundDuration,roundEndTimes:r}}),a(!1),s({title:"",description:"",imageUrl:"",startingPrice:100,incrementStep:50,startTime:"",endTime:"",donor:"",category:""}),c({enabled:!1,totalRounds:3,roundDuration:30})},o=(e,t)=>{s(a=>({...a,[e]:t}))},h=(e,t)=>{c(a=>({...a,[e]:t}))};return(0,n.FD)(Y,{open:t,onOpenChange:a,children:[(0,n.Y)(b,{asChild:!0,children:(0,n.FD)(g,{children:[(0,n.Y)(eh.A,{className:"h-4 w-4 mr-2"}),"添加拍品"]})}),(0,n.FD)(y,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,n.Y)(w,{children:(0,n.Y)(S,{children:"添加新拍品"})}),(0,n.FD)(U,{defaultValue:"basic",className:"w-full",children:[(0,n.FD)(E,{className:"grid w-full grid-cols-2",children:[(0,n.Y)(j,{value:"basic",children:"基本信息"}),(0,n.FD)(j,{value:"rounds",className:"flex items-center gap-2",children:[(0,n.Y)(ee.A,{className:"h-4 w-4"}),"多轮设置"]})]}),(0,n.Y)(I,{value:"basic",className:"mt-6",children:(0,n.FD)("form",{onSubmit:m,className:"space-y-6",children:[(0,n.FD)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.FD)("div",{children:[(0,n.Y)(R,{htmlFor:"title",children:"拍品名称 *"}),(0,n.Y)(x,{id:"title",value:i.title,onChange:e=>o("title",e.target.value),placeholder:"请输入拍品名称",required:!0})]}),(0,n.FD)("div",{children:[(0,n.Y)(R,{htmlFor:"category",children:"类别"}),(0,n.Y)(x,{id:"category",value:i.category,onChange:e=>o("category",e.target.value),placeholder:"如：艺术品、古董等"})]})]}),(0,n.FD)("div",{children:[(0,n.Y)(R,{htmlFor:"description",children:"描述 *"}),(0,n.Y)(C,{id:"description",value:i.description,onChange:e=>o("description",e.target.value),placeholder:"请详细描述拍品信息",rows:3,required:!0})]}),(0,n.Y)(eo,{value:i.imageUrl,onChange:e=>{s(t=>({...t,imageUrl:e}))},label:"拍品图片 *"}),(0,n.FD)("div",{children:[(0,n.Y)(R,{htmlFor:"donor",children:"捐赠者"}),(0,n.Y)(x,{id:"donor",value:i.donor,onChange:e=>o("donor",e.target.value),placeholder:"捐赠者姓名或机构"})]}),(0,n.FD)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.FD)("div",{children:[(0,n.Y)(R,{htmlFor:"startingPrice",children:"起拍价 (元)"}),(0,n.Y)(x,{id:"startingPrice",type:"number",value:i.startingPrice,onChange:e=>o("startingPrice",Number(e.target.value)),min:"1"})]}),(0,n.FD)("div",{children:[(0,n.Y)(R,{htmlFor:"incrementStep",children:"最小加价 (元)"}),(0,n.Y)(x,{id:"incrementStep",type:"number",value:i.incrementStep,onChange:e=>o("incrementStep",Number(e.target.value)),min:"1"})]})]}),(0,n.FD)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.FD)("div",{children:[(0,n.Y)(R,{htmlFor:"startTime",children:"开始时间"}),(0,n.Y)(x,{id:"startTime",type:"datetime-local",value:i.startTime,onChange:e=>o("startTime",e.target.value)})]}),(0,n.FD)("div",{children:[(0,n.Y)(R,{htmlFor:"endTime",children:"结束时间"}),(0,n.Y)(x,{id:"endTime",type:"datetime-local",value:i.endTime,onChange:e=>o("endTime",e.target.value),disabled:d.enabled}),d.enabled&&(0,n.Y)("p",{className:"text-xs text-yellow-600 mt-1",children:"多轮竞拍模式下，结束时间将自动计算"})]})]})]})}),(0,n.Y)(I,{value:"rounds",className:"mt-6",children:(0,n.FD)("div",{className:"space-y-6",children:[(0,n.FD)("div",{className:"flex items-center justify-between",children:[(0,n.FD)("div",{children:[(0,n.Y)(R,{htmlFor:"enable-rounds",children:"启用多轮竞拍"}),(0,n.Y)("p",{className:"text-sm text-gray-600",children:"开启后将分轮次进行竞拍"})]}),(0,n.Y)(W,{id:"enable-rounds",checked:d.enabled,onCheckedChange:e=>h("enabled",e)})]}),d.enabled&&(0,n.FD)(n.FK,{children:[(0,n.FD)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,n.Y)("h3",{className:"font-medium text-blue-900 mb-2",children:"多轮竞拍说明"}),(0,n.FD)("ul",{className:"text-sm text-blue-800 space-y-1",children:[(0,n.Y)("li",{children:"• 拍卖将分为多个轮次进行"}),(0,n.Y)("li",{children:"• 每轮有固定的时间限制"}),(0,n.Y)("li",{children:"• 每轮结束时的最高出价者可进入下一轮"}),(0,n.Y)("li",{children:"• 最后一轮的最高出价者获得拍品"})]})]}),(0,n.FD)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.FD)("div",{children:[(0,n.Y)(R,{htmlFor:"total-rounds",children:"竞拍轮数"}),(0,n.Y)(x,{id:"total-rounds",type:"number",min:"2",max:"5",value:d.totalRounds,onChange:e=>h("totalRounds",Number(e.target.value))}),(0,n.Y)("p",{className:"text-xs text-gray-600 mt-1",children:"建议2-3轮"})]}),(0,n.FD)("div",{children:[(0,n.Y)(R,{htmlFor:"round-duration",children:"每轮时长（分钟）"}),(0,n.Y)(x,{id:"round-duration",type:"number",min:"5",max:"120",value:d.roundDuration,onChange:e=>h("roundDuration",Number(e.target.value))}),(0,n.Y)("p",{className:"text-xs text-gray-600 mt-1",children:"建议15-30分钟"})]})]}),i.startTime&&(0,n.FD)("div",{children:[(0,n.Y)(R,{children:"轮次时间预览"}),(0,n.Y)("div",{className:"space-y-2 mt-2",children:Array.from({length:d.totalRounds},(e,t)=>{let a=t+1,l=new Date(0===t?i.startTime:new Date(i.startTime).getTime()+t*d.roundDuration*6e4),r=new Date(new Date(i.startTime).getTime()+a*d.roundDuration*6e4);return(0,n.Y)("div",{className:"flex items-center justify-between p-2 border rounded",children:(0,n.FD)("div",{className:"flex items-center gap-2",children:[(0,n.FD)("span",{className:"font-medium",children:["第 ",a," 轮"]}),(0,n.FD)("span",{className:"text-sm text-gray-600",children:[l.toLocaleString("zh-CN",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})," - ",r.toLocaleString("zh-CN",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]})},a)})})]})]})]})})]}),(0,n.FD)("div",{className:"flex gap-2 pt-4",children:[(0,n.Y)(g,{onClick:m,className:"flex-1",children:"添加拍品"}),(0,n.Y)(g,{type:"button",variant:"outline",onClick:()=>a(!1),children:"取消"})]})]})]})}var eg=a(8271);function ep(){let{paymentInfo:e,updatePaymentInfo:t}=(0,r.d)(),[a,i]=(0,l.useState)(!1),[o,h]=(0,l.useState)(null),[u,p]=(0,l.useState)(e.organizer),[v,N]=(0,l.useState)({type:"bank",name:"",account:"",qrCodeUrl:"",instructions:"",isActive:!0}),D=a=>{t({...e,methods:e.methods.map(e=>e.id===a.id?a:e)}),h(null)},F=a=>{confirm("确定要删除这个支付方式吗？")&&t({...e,methods:e.methods.filter(e=>e.id!==a)})},A=(a,n)=>{t({...e,methods:e.methods.map(e=>e.id===a?{...e,isActive:n}:e)})},T=e=>{switch(e){case"bank":return(0,n.Y)(M.A,{className:"h-4 w-4"});case"alipay":case"wechat":return(0,n.Y)(G.A,{className:"h-4 w-4"});default:return(0,n.Y)(eg.A,{className:"h-4 w-4"})}};return(0,n.FD)(Y,{open:a,onOpenChange:i,children:[(0,n.Y)(b,{asChild:!0,children:(0,n.FD)(g,{variant:"outline",children:[(0,n.Y)(eg.A,{className:"h-4 w-4 mr-2"}),"支付设置"]})}),(0,n.FD)(y,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,n.Y)(w,{children:(0,n.Y)(S,{children:"支付方式管理"})}),(0,n.FD)(U,{defaultValue:"methods",className:"w-full",children:[(0,n.FD)(E,{className:"grid w-full grid-cols-3",children:[(0,n.Y)(j,{value:"methods",children:"支付方式"}),(0,n.Y)(j,{value:"add",children:"添加方式"}),(0,n.Y)(j,{value:"organizer",children:"组织信息"})]}),(0,n.Y)(I,{value:"methods",className:"mt-6",children:(0,n.FD)("div",{className:"space-y-4",children:[(0,n.Y)("h3",{className:"text-lg font-medium",children:"现有支付方式"}),(0,n.Y)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.methods.map(e=>(0,n.FD)(s,{className:"relative",children:[(0,n.Y)(d,{className:"pb-3",children:(0,n.FD)(c,{className:"flex items-center justify-between",children:[(0,n.FD)("div",{className:"flex items-center gap-2",children:[T(e.type),e.name]}),(0,n.FD)("div",{className:"flex items-center gap-2",children:[(0,n.Y)(W,{checked:e.isActive,onCheckedChange:t=>A(e.id,t)}),(0,n.Y)(g,{variant:"ghost",size:"sm",onClick:()=>h(e),children:"编辑"}),(0,n.Y)(g,{variant:"ghost",size:"sm",onClick:()=>F(e.id),children:(0,n.Y)(en.A,{className:"h-4 w-4"})})]})]})}),(0,n.FD)(m,{className:"space-y-2",children:[e.account&&(0,n.FD)("div",{children:[(0,n.Y)("span",{className:"text-sm text-gray-600",children:"账号："}),(0,n.Y)("span",{className:"font-mono",children:e.account})]}),(0,n.FD)("div",{children:[(0,n.Y)("span",{className:"text-sm text-gray-600",children:"说明："}),(0,n.Y)("p",{className:"text-sm",children:e.instructions})]}),(0,n.Y)(f,{variant:e.isActive?"default":"secondary",children:e.isActive?"启用":"禁用"})]})]},e.id))})]})}),(0,n.Y)(I,{value:"add",className:"mt-6",children:(0,n.FD)("div",{className:"space-y-6",children:[(0,n.Y)("h3",{className:"text-lg font-medium",children:"添加新的支付方式"}),(0,n.FD)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.FD)("div",{children:[(0,n.Y)(R,{htmlFor:"method-type",children:"支付类型"}),(0,n.FD)("select",{id:"method-type",className:"w-full p-2 border rounded-md",value:v.type,onChange:e=>N({...v,type:e.target.value}),children:[(0,n.Y)("option",{value:"bank",children:"银行转账"}),(0,n.Y)("option",{value:"alipay",children:"支付宝"}),(0,n.Y)("option",{value:"wechat",children:"微信"}),(0,n.Y)("option",{value:"qrcode",children:"二维码"})]})]}),(0,n.FD)("div",{children:[(0,n.Y)(R,{htmlFor:"method-name",children:"方式名称"}),(0,n.Y)(x,{id:"method-name",value:v.name,onChange:e=>N({...v,name:e.target.value}),placeholder:"如：中国工商银行"})]})]}),(0,n.FD)("div",{children:[(0,n.Y)(R,{htmlFor:"method-account",children:"账号信息"}),(0,n.Y)(x,{id:"method-account",value:v.account,onChange:e=>N({...v,account:e.target.value}),placeholder:"银行账号或支付宝账号"})]}),(0,n.FD)("div",{children:[(0,n.Y)(R,{htmlFor:"method-qr",children:"二维码链接"}),(0,n.Y)(x,{id:"method-qr",value:v.qrCodeUrl,onChange:e=>N({...v,qrCodeUrl:e.target.value}),placeholder:"二维码图片URL（可选）"})]}),(0,n.FD)("div",{children:[(0,n.Y)(R,{htmlFor:"method-instructions",children:"支付说明"}),(0,n.Y)(C,{id:"method-instructions",value:v.instructions,onChange:e=>N({...v,instructions:e.target.value}),placeholder:"请输入详细的支付说明和注意事项",rows:3})]}),(0,n.FD)(g,{onClick:()=>{if(!v.name||!v.instructions)return void alert("请填写支付方式名称和说明");let a={id:Date.now().toString(),type:v.type,name:v.name,account:v.account||"",qrCodeUrl:v.qrCodeUrl||"",instructions:v.instructions,isActive:v.isActive||!0};t({...e,methods:[...e.methods,a]}),N({type:"bank",name:"",account:"",qrCodeUrl:"",instructions:"",isActive:!0})},className:"w-full",children:[(0,n.Y)(eh.A,{className:"h-4 w-4 mr-2"}),"添加支付方式"]})]})}),(0,n.Y)(I,{value:"organizer",className:"mt-6",children:(0,n.FD)("div",{className:"space-y-6",children:[(0,n.Y)("h3",{className:"text-lg font-medium",children:"组织信息设置"}),(0,n.FD)("div",{className:"grid grid-cols-1 gap-4",children:[(0,n.FD)("div",{children:[(0,n.Y)(R,{htmlFor:"org-name",children:"组织名称"}),(0,n.Y)(x,{id:"org-name",value:u.name,onChange:e=>p({...u,name:e.target.value}),placeholder:"慈善组织名称"})]}),(0,n.FD)("div",{children:[(0,n.Y)(R,{htmlFor:"org-phone",children:"联系电话"}),(0,n.Y)(x,{id:"org-phone",value:u.phone,onChange:e=>p({...u,phone:e.target.value}),placeholder:"客服电话"})]}),(0,n.FD)("div",{children:[(0,n.Y)(R,{htmlFor:"org-email",children:"邮箱地址"}),(0,n.Y)(x,{id:"org-email",type:"email",value:u.email,onChange:e=>p({...u,email:e.target.value}),placeholder:"联系邮箱"})]})]}),(0,n.Y)(g,{onClick:()=>{t({...e,organizer:u}),alert("组织信息已更新")},className:"w-full",children:"保存组织信息"})]})})]}),o&&(0,n.Y)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,n.FD)("div",{className:"bg-white p-6 rounded-lg max-w-md w-full mx-4",children:[(0,n.Y)("h3",{className:"text-lg font-medium mb-4",children:"编辑支付方式"}),(0,n.FD)("div",{className:"space-y-4",children:[(0,n.FD)("div",{children:[(0,n.Y)(R,{children:"方式名称"}),(0,n.Y)(x,{value:o.name,onChange:e=>h({...o,name:e.target.value})})]}),(0,n.FD)("div",{children:[(0,n.Y)(R,{children:"账号信息"}),(0,n.Y)(x,{value:o.account,onChange:e=>h({...o,account:e.target.value})})]}),(0,n.FD)("div",{children:[(0,n.Y)(R,{children:"二维码链接"}),(0,n.Y)(x,{value:o.qrCodeUrl,onChange:e=>h({...o,qrCodeUrl:e.target.value})})]}),(0,n.FD)("div",{children:[(0,n.Y)(R,{children:"支付说明"}),(0,n.Y)(C,{value:o.instructions,onChange:e=>h({...o,instructions:e.target.value}),rows:3})]}),(0,n.FD)("div",{className:"flex gap-2",children:[(0,n.Y)(g,{onClick:()=>D(o),className:"flex-1",children:"保存"}),(0,n.Y)(g,{variant:"outline",onClick:()=>h(null),className:"flex-1",children:"取消"})]})]})]})})]})]})}var ef=a(5299),ex=a(8718),ev=a(6037),eN=a(8390),eY=a(286),eb=a(659),eD=a(1467),eF=a(1920);function ey(){let{items:e}=(0,r.d)(),[t,a]=(0,l.useState)(!1),[i,o]=(0,l.useState)(null),h=e=>"\xa5".concat(e.toLocaleString());return(0,n.FD)(Y,{open:t,onOpenChange:a,children:[(0,n.Y)(b,{asChild:!0,children:(0,n.FD)(g,{variant:"outline",onClick:()=>{let t=new Date,a=e.filter(e=>"ended"===e.status);e.filter(e=>"active"===e.status),e.filter(e=>"upcoming"===e.status);let n=a.reduce((e,t)=>e+t.currentPrice,0),l=e.reduce((e,t)=>e+t.bids.length,0),r=new Set;e.forEach(e=>{e.bids.forEach(e=>{r.add(e.bidderName)})});let i=a.map(e=>({item:e,finalPrice:e.currentPrice,bidCount:e.bids.length,winner:e.bids.length>0?e.bids[e.bids.length-1].bidderInfo:void 0,priceIncrease:e.currentPrice-e.startingPrice,popularityScore:e.bids.length*(e.currentPrice/e.startingPrice)})),s=new Map;a.forEach(e=>{let t=e.category||"其他";s.has(t)||s.set(t,{itemCount:0,totalRaised:0,items:[]});let a=s.get(t);a.itemCount++,a.totalRaised+=e.currentPrice,a.items.push(e)});let d=Array.from(s.entries()).map(e=>{let[t,a]=e;return{category:t,itemCount:a.itemCount,totalRaised:a.totalRaised,averagePrice:a.totalRaised/a.itemCount}}),c=e.map(e=>({time:e.endTime,totalRaised:e.currentPrice,activeBids:e.bids.length})).sort((e,t)=>e.time.getTime()-t.time.getTime()),m={id:Date.now().toString(),generatedAt:t,period:{start:e.length>0?new Date(Math.min(...e.map(e=>e.startTime.getTime()))):t,end:t},summary:{totalItems:e.length,totalBids:l,totalRaised:n,participantCount:r.size,completedItems:a.length},itemReports:i,categoryBreakdown:d,timelineData:c};o(m)},children:[(0,n.Y)(V.A,{className:"h-4 w-4 mr-2"}),"生成活动报告"]})}),(0,n.FD)(y,{className:"max-w-6xl max-h-[90vh] overflow-y-auto",children:[(0,n.FD)(w,{children:[(0,n.FD)(S,{className:"flex items-center gap-2",children:[(0,n.Y)(ef.A,{className:"h-5 w-5"}),"晓日春晖慈善拍卖会 - 活动报告"]}),(0,n.FD)("div",{className:"flex items-center justify-between",children:[(0,n.FD)("span",{className:"text-sm text-muted-foreground",children:["生成时间：",null==i?void 0:i.generatedAt.toLocaleString("zh-CN")]}),(0,n.FD)(g,{onClick:()=>{if(!i)return;let e=new Blob(["\n晓日春晖慈善拍卖会 - 活动总结报告\n生成时间：".concat(i.generatedAt.toLocaleString("zh-CN"),"\n统计期间：").concat(i.period.start.toLocaleDateString("zh-CN")," - ").concat(i.period.end.toLocaleDateString("zh-CN"),"\n\n=== 活动概览 ===\n拍品总数：").concat(i.summary.totalItems,"\n完成拍卖：").concat(i.summary.completedItems,"\n总筹善款：\xa5").concat(i.summary.totalRaised.toLocaleString(),"\n参与人数：").concat(i.summary.participantCount,"\n竞拍次数：").concat(i.summary.totalBids,"\n\n=== 分类统计 ===\n").concat(i.categoryBreakdown.map(e=>"".concat(e.category,"：").concat(e.itemCount,"件，筹款\xa5").concat(e.totalRaised.toLocaleString(),"，平均\xa5").concat(Math.round(e.averagePrice))).join("\n"),"\n\n=== 拍品详情 ===\n").concat(i.itemReports.map(e=>"".concat(e.item.title,"：起拍\xa5").concat(e.item.startingPrice," → 成交\xa5").concat(e.finalPrice,"，").concat(e.bidCount,"次竞拍")).join("\n"),"\n\n感谢所有参与者的爱心支持！\n    ")],{type:"text/plain;charset=utf-8"}),t=URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download="晓日春晖慈善拍卖会报告_".concat(new Date().toLocaleDateString("zh-CN"),".txt"),document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(t)},disabled:!i,size:"sm",children:[(0,n.Y)(ex.A,{className:"h-4 w-4 mr-1"}),"下载报告"]})]})]}),i&&(0,n.FD)(U,{defaultValue:"overview",className:"w-full",children:[(0,n.FD)(E,{className:"grid w-full grid-cols-4",children:[(0,n.Y)(j,{value:"overview",children:"活动概览"}),(0,n.Y)(j,{value:"items",children:"拍品分析"}),(0,n.Y)(j,{value:"categories",children:"分类统计"}),(0,n.Y)(j,{value:"timeline",children:"时间线"})]}),(0,n.FD)(I,{value:"overview",className:"space-y-6",children:[(0,n.FD)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,n.FD)(s,{children:[(0,n.Y)(d,{className:"pb-2",children:(0,n.FD)(c,{className:"flex items-center gap-2 text-sm",children:[(0,n.Y)(ev.A,{className:"h-4 w-4"}),"拍品总数"]})}),(0,n.FD)(m,{children:[(0,n.Y)("div",{className:"text-2xl font-bold",children:i.summary.totalItems}),(0,n.FD)("p",{className:"text-xs text-muted-foreground",children:["完成 ",i.summary.completedItems," 件"]})]})]}),(0,n.FD)(s,{children:[(0,n.Y)(d,{className:"pb-2",children:(0,n.FD)(c,{className:"flex items-center gap-2 text-sm",children:[(0,n.Y)(eN.A,{className:"h-4 w-4"}),"筹款总额"]})}),(0,n.FD)(m,{children:[(0,n.Y)("div",{className:"text-2xl font-bold text-green-600",children:h(i.summary.totalRaised)}),(0,n.Y)("p",{className:"text-xs text-muted-foreground",children:"已完成拍品"})]})]}),(0,n.FD)(s,{children:[(0,n.Y)(d,{className:"pb-2",children:(0,n.FD)(c,{className:"flex items-center gap-2 text-sm",children:[(0,n.Y)(eY.A,{className:"h-4 w-4"}),"参与人数"]})}),(0,n.FD)(m,{children:[(0,n.Y)("div",{className:"text-2xl font-bold",children:i.summary.participantCount}),(0,n.Y)("p",{className:"text-xs text-muted-foreground",children:"爱心人士"})]})]}),(0,n.FD)(s,{children:[(0,n.Y)(d,{className:"pb-2",children:(0,n.FD)(c,{className:"flex items-center gap-2 text-sm",children:[(0,n.Y)(eb.A,{className:"h-4 w-4"}),"竞拍次数"]})}),(0,n.FD)(m,{children:[(0,n.Y)("div",{className:"text-2xl font-bold",children:i.summary.totalBids}),(0,n.Y)("p",{className:"text-xs text-muted-foreground",children:"总出价次数"})]})]})]}),(0,n.FD)(s,{children:[(0,n.Y)(d,{children:(0,n.Y)(c,{children:"活动亮点"})}),(0,n.Y)(m,{className:"space-y-4",children:i.itemReports.length>0&&(0,n.FD)(n.FK,{children:[(0,n.FD)("div",{className:"flex items-center justify-between p-3 bg-yellow-50 rounded-lg",children:[(0,n.FD)("div",{className:"flex items-center gap-2",children:[(0,n.Y)(eD.A,{className:"h-5 w-5 text-yellow-600"}),(0,n.Y)("span",{className:"font-medium",children:"最受欢迎拍品"})]}),(0,n.Y)("div",{className:"text-right",children:(()=>{let e=i.itemReports.reduce((e,t)=>e.popularityScore>t.popularityScore?e:t);return(0,n.FD)("div",{children:[(0,n.Y)("div",{className:"font-bold",children:e.item.title}),(0,n.FD)("div",{className:"text-sm text-muted-foreground",children:[e.bidCount," 次竞拍"]})]})})()})]}),(0,n.FD)("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:[(0,n.FD)("div",{className:"flex items-center gap-2",children:[(0,n.Y)(eb.A,{className:"h-5 w-5 text-green-600"}),(0,n.Y)("span",{className:"font-medium",children:"最高成交价"})]}),(0,n.Y)("div",{className:"text-right",children:(()=>{let e=i.itemReports.reduce((e,t)=>e.finalPrice>t.finalPrice?e:t);return(0,n.FD)("div",{children:[(0,n.Y)("div",{className:"font-bold",children:h(e.finalPrice)}),(0,n.Y)("div",{className:"text-sm text-muted-foreground",children:e.item.title})]})})()})]}),(0,n.FD)("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg",children:[(0,n.FD)("div",{className:"flex items-center gap-2",children:[(0,n.Y)(eF.A,{className:"h-5 w-5 text-blue-600"}),(0,n.Y)("span",{className:"font-medium",children:"活动周期"})]}),(0,n.FD)("div",{className:"text-right",children:[(0,n.FD)("div",{className:"font-bold",children:[Math.ceil((i.period.end.getTime()-i.period.start.getTime())/864e5)," 天"]}),(0,n.FD)("div",{className:"text-sm text-muted-foreground",children:[i.period.start.toLocaleDateString("zh-CN")," - ",i.period.end.toLocaleDateString("zh-CN")]})]})]})]})})]})]}),(0,n.Y)(I,{value:"items",className:"space-y-4",children:(0,n.Y)("div",{className:"grid gap-4",children:i.itemReports.map((e,t)=>(0,n.Y)(s,{children:(0,n.Y)(m,{className:"p-4",children:(0,n.FD)("div",{className:"flex items-start gap-4",children:[(0,n.Y)("img",{src:e.item.imageUrl,alt:e.item.title,className:"w-16 h-16 object-cover rounded"}),(0,n.FD)("div",{className:"flex-1",children:[(0,n.FD)("div",{className:"flex items-start justify-between",children:[(0,n.FD)("div",{children:[(0,n.Y)("h3",{className:"font-medium",children:e.item.title}),(0,n.Y)("p",{className:"text-sm text-muted-foreground",children:e.item.category})]}),(0,n.FD)(f,{variant:"outline",children:[e.bidCount," 次竞拍"]})]}),(0,n.FD)("div",{className:"mt-2 grid grid-cols-3 gap-4 text-sm",children:[(0,n.FD)("div",{children:[(0,n.Y)("span",{className:"text-muted-foreground",children:"起拍价："}),(0,n.Y)("span",{className:"font-medium",children:h(e.item.startingPrice)})]}),(0,n.FD)("div",{children:[(0,n.Y)("span",{className:"text-muted-foreground",children:"成交价："}),(0,n.Y)("span",{className:"font-bold text-green-600",children:h(e.finalPrice)})]}),(0,n.FD)("div",{children:[(0,n.Y)("span",{className:"text-muted-foreground",children:"涨幅："}),(0,n.FD)("span",{className:"font-medium",children:["+",h(e.priceIncrease),"(",(e.priceIncrease/e.item.startingPrice*100).toFixed(1),"%)"]})]})]})]})]})})},t))})}),(0,n.Y)(I,{value:"categories",className:"space-y-4",children:(0,n.Y)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:i.categoryBreakdown.map((e,t)=>(0,n.FD)(s,{children:[(0,n.Y)(d,{children:(0,n.FD)(c,{className:"flex items-center justify-between",children:[e.category,(0,n.FD)(f,{children:[e.itemCount," 件"]})]})}),(0,n.Y)(m,{children:(0,n.FD)("div",{className:"space-y-2",children:[(0,n.FD)("div",{className:"flex justify-between",children:[(0,n.Y)("span",{children:"筹款总额："}),(0,n.Y)("span",{className:"font-bold text-green-600",children:h(e.totalRaised)})]}),(0,n.FD)("div",{className:"flex justify-between",children:[(0,n.Y)("span",{children:"平均成交价："}),(0,n.Y)("span",{className:"font-medium",children:h(e.averagePrice)})]}),(0,n.FD)("div",{className:"flex justify-between",children:[(0,n.Y)("span",{children:"占总筹款："}),(0,n.FD)("span",{children:[(e.totalRaised/i.summary.totalRaised*100).toFixed(1),"%"]})]})]})})]},t))})}),(0,n.Y)(I,{value:"timeline",className:"space-y-4",children:(0,n.FD)(s,{children:[(0,n.Y)(d,{children:(0,n.Y)(c,{children:"活动时间线"})}),(0,n.Y)(m,{children:(0,n.Y)("div",{className:"space-y-4",children:i.timelineData.slice(0,10).map((e,t)=>(0,n.FD)("div",{className:"flex items-center gap-4 p-3 border rounded-lg",children:[(0,n.Y)("div",{className:"w-20 text-sm text-muted-foreground",children:e.time.toLocaleDateString("zh-CN")}),(0,n.Y)("div",{className:"flex-1",children:(0,n.Y)("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,n.Y)("div",{className:"h-full bg-green-500 transition-all",style:{width:"".concat(e.totalRaised/Math.max(...i.timelineData.map(e=>e.totalRaised))*100,"%")}})})}),(0,n.Y)("div",{className:"w-24 text-sm font-medium text-right",children:h(e.totalRaised)})]},t))})})]})})]})]})]})}var ew=a(7390),eS=a(8224);function eC(){let[e,t]=(0,l.useState)(!1),[a,r]=(0,l.useState)(""),[i,o]=(0,l.useState)(""),h=window.location.href,u="晓日春晖慈善拍卖会",p="诚邀您参与晓日春晖慈善拍卖会，为公益事业贡献一份爱心！";(0,l.useEffect)(()=>{e&&h&&o("https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=".concat(encodeURIComponent(h),"&format=png&ecc=M&margin=10"))},[e,h]);let f=async(e,t)=>{try{await navigator.clipboard.writeText(e),r(t),setTimeout(()=>r(""),2e3)}catch(e){alert("复制失败，请手动复制")}},v="".concat(u,"\n").concat(p,"\n\n参与链接：").concat(h);return(0,n.FD)(Y,{open:e,onOpenChange:t,children:[(0,n.Y)(b,{asChild:!0,children:(0,n.FD)(g,{variant:"outline",children:[(0,n.Y)(ew.A,{className:"h-4 w-4 mr-2"}),"分享拍卖会"]})}),(0,n.FD)(y,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,n.Y)(w,{children:(0,n.FD)(S,{className:"flex items-center gap-2",children:[(0,n.Y)(ew.A,{className:"h-5 w-5"}),"分享晓日春晖慈善拍卖会"]})}),(0,n.FD)("div",{className:"space-y-6",children:[(0,n.FD)(s,{children:[(0,n.Y)(d,{children:(0,n.Y)(c,{className:"text-lg",children:"活动信息"})}),(0,n.FD)(m,{className:"space-y-3",children:[(0,n.FD)("div",{children:[(0,n.Y)("h3",{className:"font-medium text-lg mb-2",children:u}),(0,n.Y)("p",{className:"text-muted-foreground",children:p})]}),(0,n.Y)("div",{className:"bg-blue-50 p-3 rounded-lg",children:(0,n.FD)("p",{className:"text-sm text-blue-800",children:["\uD83D\uDC9D 每一次竞拍都是一份爱心",(0,n.Y)("br",{}),"\uD83C\uDF1F 所有收益将用于公益事业",(0,n.Y)("br",{}),"\uD83E\uDD1D 期待您的参与和支持"]})})]})]}),(0,n.FD)(s,{children:[(0,n.Y)(d,{children:(0,n.Y)(c,{children:"快速分享"})}),(0,n.Y)(m,{className:"space-y-3",children:(0,n.FD)("div",{className:"grid grid-cols-2 gap-3",children:[(0,n.FD)(g,{onClick:()=>{f("".concat(u,"\n").concat(p,"\n\n参与链接：").concat(h),"wechat"),alert("链接已复制，请在微信中粘贴分享")},className:"flex items-center gap-2",variant:"outline",children:[(0,n.Y)(eS.A,{className:"h-4 w-4"}),"分享到微信","wechat"===a&&(0,n.Y)(X.A,{className:"h-4 w-4 ml-auto"})]}),(0,n.FD)(g,{onClick:()=>{let e=encodeURIComponent(u),t=encodeURIComponent("".concat(p,"\n\n参与链接：").concat(h,"\n\n期待您的参与！"));window.open("mailto:?subject=".concat(e,"&body=").concat(t))},className:"flex items-center gap-2",variant:"outline",children:[(0,n.Y)(q.A,{className:"h-4 w-4"}),"邮件分享"]})]})})]}),(0,n.FD)(s,{children:[(0,n.Y)(d,{children:(0,n.FD)(c,{className:"flex items-center gap-2",children:[(0,n.Y)(es.A,{className:"h-4 w-4"}),"分享链接"]})}),(0,n.FD)(m,{className:"space-y-4",children:[(0,n.FD)("div",{children:[(0,n.Y)("label",{className:"text-sm font-medium",children:"活动链接"}),(0,n.FD)("div",{className:"flex gap-2 mt-1",children:[(0,n.Y)(x,{value:h,readOnly:!0,className:"flex-1"}),(0,n.Y)(g,{onClick:()=>f(h,"url"),variant:"outline",children:"url"===a?(0,n.Y)(X.A,{className:"h-4 w-4"}):(0,n.Y)($.A,{className:"h-4 w-4"})})]})]}),(0,n.FD)("div",{children:[(0,n.Y)("label",{className:"text-sm font-medium",children:"完整分享文本"}),(0,n.FD)("div",{className:"mt-1",children:[(0,n.Y)("textarea",{value:v,readOnly:!0,className:"w-full p-3 border rounded-md resize-none h-24 text-sm"}),(0,n.Y)(g,{onClick:()=>f(v,"text"),className:"mt-2 w-full",variant:"outline",children:"text"===a?(0,n.FD)(n.FK,{children:[(0,n.Y)(X.A,{className:"h-4 w-4 mr-2"}),"已复制文本"]}):(0,n.FD)(n.FK,{children:[(0,n.Y)($.A,{className:"h-4 w-4 mr-2"}),"复制分享文本"]})})]})]})]})]}),(0,n.FD)(s,{children:[(0,n.Y)(d,{children:(0,n.FD)(c,{className:"flex items-center gap-2",children:[(0,n.Y)(J.A,{className:"h-4 w-4"}),"二维码分享"]})}),(0,n.FD)(m,{className:"space-y-4",children:[(0,n.Y)("div",{className:"text-center",children:i&&(0,n.FD)("div",{className:"inline-block",children:[(0,n.Y)("img",{src:i,alt:"拍卖会二维码",className:"w-64 h-64 mx-auto border rounded-lg"}),(0,n.FD)("div",{className:"mt-3 space-y-2",children:[(0,n.Y)("p",{className:"text-sm text-muted-foreground",children:"扫描二维码参与晓日春晖慈善拍卖会"}),(0,n.FD)("div",{className:"flex gap-2 justify-center",children:[(0,n.FD)(g,{onClick:()=>{if(!i)return;let e=document.createElement("a");e.href=i,e.download="晓日春晖慈善拍卖会二维码.png",document.body.appendChild(e),e.click(),document.body.removeChild(e)},variant:"outline",size:"sm",children:[(0,n.Y)(ex.A,{className:"h-4 w-4 mr-1"}),"下载二维码"]}),(0,n.FD)(g,{onClick:()=>f(i,"qr"),variant:"outline",size:"sm",children:["qr"===a?(0,n.Y)(X.A,{className:"h-4 w-4 mr-1"}):(0,n.Y)($.A,{className:"h-4 w-4 mr-1"}),"复制图片链接"]})]})]})]})}),(0,n.FD)("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:[(0,n.Y)("h4",{className:"font-medium text-amber-900 mb-2",children:"使用建议"}),(0,n.FD)("ul",{className:"text-sm text-amber-800 space-y-1",children:[(0,n.Y)("li",{children:"• 可将二维码保存到相册，在社交媒体分享"}),(0,n.Y)("li",{children:"• 打印二维码张贴在合适的宣传位置"}),(0,n.Y)("li",{children:"• 发送给亲朋好友，邀请他们参与公益活动"}),(0,n.Y)("li",{children:"• 在企业内部或社群中推广传播"})]})]})]})]}),(0,n.FD)(s,{children:[(0,n.Y)(d,{children:(0,n.Y)(c,{children:"传播小贴士"})}),(0,n.Y)(m,{children:(0,n.FD)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(0,n.FD)("div",{className:"space-y-2",children:[(0,n.FD)("h4",{className:"font-medium flex items-center gap-2",children:[(0,n.Y)(G.A,{className:"h-4 w-4"}),"线上传播"]}),(0,n.FD)("ul",{className:"space-y-1 text-muted-foreground",children:[(0,n.Y)("li",{children:"• 微信朋友圈分享"}),(0,n.Y)("li",{children:"• 微信群转发"}),(0,n.Y)("li",{children:"• 企业内部群推广"}),(0,n.Y)("li",{children:"• 社交媒体发布"})]})]}),(0,n.FD)("div",{className:"space-y-2",children:[(0,n.FD)("h4",{className:"font-medium flex items-center gap-2",children:[(0,n.Y)(J.A,{className:"h-4 w-4"}),"线下推广"]}),(0,n.FD)("ul",{className:"space-y-1 text-muted-foreground",children:[(0,n.Y)("li",{children:"• 打印二维码海报"}),(0,n.Y)("li",{children:"• 办公场所张贴"}),(0,n.Y)("li",{children:"• 活动现场展示"}),(0,n.Y)("li",{children:"• 宣传册加入二维码"})]})]})]})})]})]})]})]})}var eA=a(6936),eT=a(8098);function eR(){let{items:e,currentUser:t,setCurrentUser:a}=(0,r.d)(),[i,s]=(0,l.useState)(!1),d=e.filter(e=>"active"===e.status),c=e.filter(e=>"upcoming"===e.status),m=e.filter(e=>"ended"===e.status),o=e.filter(e=>"ended"===e.status).reduce((e,t)=>e+t.currentPrice,0);return(0,n.FD)("div",{className:"min-h-screen bg-gradient-to-br from-orange-50 via-yellow-50 to-amber-50",children:[(0,n.Y)("header",{className:"bg-white shadow-sm border-b border-orange-100",children:(0,n.Y)("div",{className:"container mx-auto px-4 py-4 mobile-optimized",children:(0,n.FD)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[(0,n.FD)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[(0,n.Y)("div",{className:"bg-gradient-to-br from-orange-500 to-yellow-600 p-2 rounded-lg flex-shrink-0",children:(0,n.Y)(eA.A,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),(0,n.FD)("div",{className:"min-w-0 flex-1",children:[(0,n.Y)("h1",{className:"text-lg sm:text-2xl font-bold bg-gradient-to-r from-orange-600 to-yellow-600 bg-clip-text text-transparent truncate",children:"晓日春晖慈善拍卖会"}),(0,n.Y)("p",{className:"text-xs sm:text-sm text-gray-600",children:"让爱心如春日暖阳，为公益事业贡献力量"})]})]}),(0,n.Y)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-3 sm:gap-4 w-full sm:w-auto",children:(0,n.FD)("div",{className:"flex items-center justify-between w-full sm:w-auto gap-4",children:[(0,n.FD)("div",{className:"text-left sm:text-right",children:[(0,n.Y)("p",{className:"text-sm text-gray-600",children:"已筹善款"}),(0,n.FD)("p",{className:"text-lg sm:text-xl font-bold text-green-600",children:["\xa5",o.toLocaleString()]})]}),(0,n.FD)("div",{className:"flex items-center gap-2",children:[(0,n.Y)(eC,{}),(0,n.FD)(g,{variant:i?"default":"outline",onClick:()=>{s(!i),i?a(null):a({id:"admin",name:"管理员",email:"admin@charity.com",isAdmin:!0})},className:"flex items-center gap-2 text-sm",size:"sm",children:[(0,n.Y)(eg.A,{className:"h-4 w-4"}),(0,n.Y)("span",{className:"hidden sm:inline",children:i?"管理模式":"切换管理"}),(0,n.Y)("span",{className:"sm:hidden",children:"管理"})]})]})]})})]})})}),(0,n.FD)("main",{className:"container mx-auto px-4 py-6 sm:py-8 mobile-optimized",children:[(0,n.FD)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 mb-6 sm:mb-8 card-grid",children:[(0,n.Y)("div",{className:"bg-white p-3 sm:p-6 rounded-lg shadow-sm border border-orange-100",children:(0,n.FD)("div",{className:"flex items-center gap-2 sm:gap-3",children:[(0,n.Y)("div",{className:"bg-green-100 p-1.5 sm:p-2 rounded-lg",children:(0,n.Y)(ev.A,{className:"h-4 w-4 sm:h-5 sm:w-5 text-green-600"})}),(0,n.FD)("div",{children:[(0,n.Y)("p",{className:"text-xs sm:text-sm text-gray-600",children:"进行中"}),(0,n.Y)("p",{className:"text-lg sm:text-2xl font-bold",children:d.length})]})]})}),(0,n.Y)("div",{className:"bg-white p-3 sm:p-6 rounded-lg shadow-sm border border-orange-100",children:(0,n.FD)("div",{className:"flex items-center gap-2 sm:gap-3",children:[(0,n.Y)("div",{className:"bg-blue-100 p-1.5 sm:p-2 rounded-lg",children:(0,n.Y)(ev.A,{className:"h-4 w-4 sm:h-5 sm:w-5 text-blue-600"})}),(0,n.FD)("div",{children:[(0,n.Y)("p",{className:"text-xs sm:text-sm text-gray-600",children:"即将开始"}),(0,n.Y)("p",{className:"text-lg sm:text-2xl font-bold",children:c.length})]})]})}),(0,n.Y)("div",{className:"bg-white p-3 sm:p-6 rounded-lg shadow-sm border border-orange-100",children:(0,n.FD)("div",{className:"flex items-center gap-2 sm:gap-3",children:[(0,n.Y)("div",{className:"bg-gray-100 p-1.5 sm:p-2 rounded-lg",children:(0,n.Y)(ev.A,{className:"h-4 w-4 sm:h-5 sm:w-5 text-gray-600"})}),(0,n.FD)("div",{children:[(0,n.Y)("p",{className:"text-xs sm:text-sm text-gray-600",children:"已结束"}),(0,n.Y)("p",{className:"text-lg sm:text-2xl font-bold",children:m.length})]})]})}),(0,n.Y)("div",{className:"bg-white p-3 sm:p-6 rounded-lg shadow-sm border border-orange-100",children:(0,n.FD)("div",{className:"flex items-center gap-2 sm:gap-3",children:[(0,n.Y)("div",{className:"bg-orange-100 p-1.5 sm:p-2 rounded-lg",children:(0,n.Y)(eT.A,{className:"h-4 w-4 sm:h-5 sm:w-5 text-orange-600"})}),(0,n.FD)("div",{children:[(0,n.Y)("p",{className:"text-xs sm:text-sm text-gray-600",children:"总筹款"}),(0,n.FD)("p",{className:"text-sm sm:text-2xl font-bold text-green-600",children:["\xa5",o.toLocaleString()]})]})]})})]}),i&&(0,n.Y)("div",{className:"bg-white p-3 sm:p-4 rounded-lg shadow-sm mb-4 sm:mb-6 border border-orange-100",children:(0,n.FD)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-0",children:[(0,n.FD)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2",children:[(0,n.Y)(f,{variant:"secondary",className:"bg-orange-100 text-orange-800 w-fit",children:"管理员模式"}),(0,n.Y)("span",{className:"text-xs sm:text-sm text-gray-600",children:"您可以管理拍品、设置支付方式、生成报告"})]}),(0,n.FD)("div",{className:"flex flex-wrap gap-2 w-full sm:w-auto",children:[(0,n.Y)(ey,{}),(0,n.Y)(ep,{}),(0,n.Y)(eu,{})]})]})}),!i&&(0,n.Y)("div",{className:"bg-gradient-to-r from-orange-100 to-yellow-100 p-6 rounded-lg mb-8 border border-orange-200",children:(0,n.FD)("div",{className:"text-center",children:[(0,n.Y)("h2",{className:"text-xl font-bold text-orange-800 mb-2",children:"晓日春晖慈善拍卖会"}),(0,n.Y)("p",{className:"text-orange-700 mb-4",children:"诚邀您参与我们的慈善拍卖活动，每一次竞拍都是一份爱心，每一笔善款都将用于公益事业。 让我们携手同行，为需要帮助的人们带去春日般的温暖。"}),(0,n.Y)("div",{className:"flex justify-center",children:(0,n.Y)(eC,{})})]})}),(0,n.FD)(U,{defaultValue:"active",className:"w-full",children:[(0,n.FD)(E,{className:"grid w-full grid-cols-3 bg-white border border-orange-200 h-auto",children:[(0,n.FD)(j,{value:"active",className:"flex flex-col sm:flex-row items-center gap-1 sm:gap-2 py-2 sm:py-3 text-xs sm:text-sm data-[state=active]:bg-orange-100",children:[(0,n.Y)("span",{children:"进行中"}),d.length>0&&(0,n.Y)(f,{variant:"secondary",className:"text-xs px-1 bg-green-100 text-green-800",children:d.length})]}),(0,n.FD)(j,{value:"upcoming",className:"flex flex-col sm:flex-row items-center gap-1 sm:gap-2 py-2 sm:py-3 text-xs sm:text-sm data-[state=active]:bg-orange-100",children:[(0,n.Y)("span",{children:"即将开始"}),c.length>0&&(0,n.Y)(f,{variant:"secondary",className:"text-xs px-1 bg-blue-100 text-blue-800",children:c.length})]}),(0,n.FD)(j,{value:"ended",className:"flex flex-col sm:flex-row items-center gap-1 sm:gap-2 py-2 sm:py-3 text-xs sm:text-sm data-[state=active]:bg-orange-100",children:[(0,n.Y)("span",{children:"已结束"}),m.length>0&&(0,n.Y)(f,{variant:"secondary",className:"text-xs px-1 bg-gray-100 text-gray-800",children:m.length})]})]}),(0,n.Y)(I,{value:"active",className:"mt-4 sm:mt-6",children:(0,n.Y)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 card-grid",children:d.length>0?d.map(e=>(0,n.Y)(ei,{item:e,isAdmin:i},e.id)):(0,n.FD)("div",{className:"col-span-full text-center py-8 sm:py-12",children:[(0,n.Y)(ev.A,{className:"h-10 w-10 sm:h-12 sm:w-12 mx-auto text-gray-400 mb-4"}),(0,n.Y)("p",{className:"text-gray-500",children:"暂无进行中的拍品"}),(0,n.Y)("p",{className:"text-sm text-gray-400 mt-2",children:"敬请期待更多精彩拍品"})]})})}),(0,n.Y)(I,{value:"upcoming",className:"mt-4 sm:mt-6",children:(0,n.Y)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 card-grid",children:c.length>0?c.map(e=>(0,n.Y)(ei,{item:e,isAdmin:i},e.id)):(0,n.FD)("div",{className:"col-span-full text-center py-8 sm:py-12",children:[(0,n.Y)(ev.A,{className:"h-10 w-10 sm:h-12 sm:w-12 mx-auto text-gray-400 mb-4"}),(0,n.Y)("p",{className:"text-gray-500",children:"暂无即将开始的拍品"}),(0,n.Y)("p",{className:"text-sm text-gray-400 mt-2",children:"请关注我们的最新动态"})]})})}),(0,n.Y)(I,{value:"ended",className:"mt-4 sm:mt-6",children:(0,n.Y)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 card-grid",children:m.length>0?m.map(e=>(0,n.Y)(ei,{item:e,isAdmin:i},e.id)):(0,n.FD)("div",{className:"col-span-full text-center py-8 sm:py-12",children:[(0,n.Y)(ev.A,{className:"h-10 w-10 sm:h-12 sm:w-12 mx-auto text-gray-400 mb-4"}),(0,n.Y)("p",{className:"text-gray-500",children:"暂无已结束的拍品"}),(0,n.Y)("p",{className:"text-sm text-gray-400 mt-2",children:"拍卖结束后的成交记录将在此显示"})]})})})]})]}),(0,n.Y)("footer",{className:"bg-white border-t border-orange-100 mt-8 sm:mt-16",children:(0,n.Y)("div",{className:"container mx-auto px-4 py-6 sm:py-8 mobile-optimized",children:(0,n.FD)("div",{className:"text-center",children:[(0,n.Y)("h3",{className:"text-base sm:text-lg font-medium text-orange-800 mb-2",children:"晓日春晖慈善拍卖会"}),(0,n.Y)("p",{className:"text-sm sm:text-base text-gray-600 mb-2",children:"让爱心如春日暖阳，照亮每一个需要帮助的角落"}),(0,n.Y)("p",{className:"text-xs sm:text-sm text-gray-500",children:"所有拍卖收益将用于慈善事业 • 感谢您的参与和支持"}),(0,n.Y)("div",{className:"mt-3 sm:mt-4",children:(0,n.Y)(eC,{})})]})})})]})}},7225:(e,t,a)=>{"use strict";a.d(t,{AuctionProvider:()=>c,d:()=>m});var n=a(5853),l=a(2115),r=a(7481);let i=(0,l.createContext)(void 0),s={methods:[{id:"1",type:"bank",name:"中国工商银行",account:"6222 0236 1234 5678 901",instructions:"请在转账备注中填写：拍品名称+竞拍者姓名，转账后请联系工作人员确认。",isActive:!0},{id:"2",type:"bank",name:"中国建设银行",account:"4367 4200 1234 5678 901",instructions:"请在转账备注中填写：拍品名称+竞拍者姓名，转账后请联系工作人员确认。",isActive:!0},{id:"3",type:"alipay",name:"支付宝收款",account:"xiaori@charityauction.org",qrCodeUrl:"https://images.unsplash.com/photo-1616864793798-81b8b90f8cf9?w=400&h=400&fit=crop",instructions:"扫描二维码或搜索账号转账，请在备注中填写拍品信息。",isActive:!0},{id:"4",type:"wechat",name:"微信收款",qrCodeUrl:"https://images.unsplash.com/photo-1616864793798-81b8b90f8cf9?w=400&h=400&fit=crop",instructions:"扫描微信收款码转账，请在备注中填写拍品信息。",isActive:!0}],organizer:{name:"晓日春晖慈善组织",phone:"400-888-9999",email:"contact@xiaori-chunhui.org"}},d=[{id:"1",title:"著名画家原创油画作品",description:"这是一幅充满艺术气息的原创油画，由知名艺术家亲笔创作，适合收藏和欣赏。画作表现了春日暖阳的温暖主题，与我们的慈善理念相呼应。",imageUrl:"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=800&h=600&fit=crop",startingPrice:1e3,currentPrice:1e3,incrementStep:100,startTime:new Date,endTime:new Date(Date.now()+6048e5),status:"active",bids:[],donor:"张艺术家",category:"艺术品",roundSettings:{enabled:!0,totalRounds:3,currentRound:1,roundDuration:30,roundEndTimes:[new Date(Date.now()+18e5),new Date(Date.now()+36e5),new Date(Date.now()+54e5)]}},{id:"2",title:"限量版书法字画",description:"书法大师亲自题写的字画作品，具有很高的收藏价值和文化意义。作品寓意着希望与温暖，正如春晖普照大地。",imageUrl:"https://images.unsplash.com/photo-1513475382585-d06e58bcb0e0?w=800&h=600&fit=crop",startingPrice:800,currentPrice:800,incrementStep:50,startTime:new Date,endTime:new Date(Date.now()+432e6),status:"active",bids:[],donor:"李书法家",category:"书法",roundSettings:{enabled:!1,totalRounds:1,currentRound:1,roundDuration:0,roundEndTimes:[]}},{id:"3",title:"古董茶具套装",description:"精美的古董茶具，工艺精湛，适合茶艺爱好者收藏使用。茶具承载着传统文化的温度，如同我们传递的爱心温暖。",imageUrl:"https://images.unsplash.com/photo-1575389384200-b82bff6b85e4?w=800&h=600&fit=crop",startingPrice:500,currentPrice:500,incrementStep:25,startTime:new Date(Date.now()+864e5),endTime:new Date(Date.now()+6912e5),status:"upcoming",bids:[],donor:"王收藏家",category:"古董",roundSettings:{enabled:!0,totalRounds:2,currentRound:0,roundDuration:20,roundEndTimes:[]}}];function c(e){let{children:t}=e,[a,c]=(0,l.useState)(d),[m,o]=(0,l.useState)(null),[h,u]=(0,l.useState)(s),[g,p]=(0,l.useState)([]),[f,x]=(0,l.useState)({bidOutbid:!0,roundStart:!0,auctionEnd:!0,paymentSuccess:!0,roundEnd:!0}),{toast:v}=(0,r.dj)(),N=(0,l.useCallback)((e,t,a,n)=>{let l={id:Date.now().toString(),type:e,title:t,message:a,itemId:n,timestamp:new Date,read:!1};p(e=>[l,...e]),f[e]&&v({title:t,description:a,duration:5e3})},[f,v]);return(0,l.useEffect)(()=>{let e=()=>{let e=new Date;c(t=>t.map(t=>{let a=t.status,n={...t.roundSettings},l=t.roundSettings.currentRound,r=t.status;if(a=e<t.startTime?"upcoming":e>t.endTime?"ended":"active",t.roundSettings.enabled&&"active"===a){let r=t.roundSettings.roundEndTimes.findIndex(t=>e<=t);r>=0?(n.currentRound=r+1,l!==n.currentRound&&l<n.currentRound&&N("roundStart","新一轮竞拍开始","「".concat(t.title,"」第 ").concat(n.currentRound," 轮竞拍已开始！"),t.id)):t.roundSettings.roundEndTimes.length>0&&e>t.roundSettings.roundEndTimes[t.roundSettings.roundEndTimes.length-1]&&(a="ended")}if("active"===r&&"ended"===a){let e=t.bids.length>0?t.bids[t.bids.length-1]:null;N("auctionEnd","拍卖结束",e?"「".concat(t.title,"」拍卖已结束，恭喜 ").concat(e.bidderName," 以 \xa5").concat(e.amount," 成功竞得！"):"「".concat(t.title,"」拍卖已结束，暂无人竞拍。"),t.id)}return{...t,status:a,roundSettings:n}}))};e();let t=setInterval(e,3e4);return()=>clearInterval(t)},[N]),(0,n.Y)(i.Provider,{value:{items:a,currentUser:m,paymentInfo:h,notifications:g,notificationSettings:f,addItem:e=>{let t={...e,id:Date.now().toString(),currentPrice:e.startingPrice,bids:[],roundSettings:e.roundSettings||{enabled:!1,totalRounds:1,currentRound:1,roundDuration:0,roundEndTimes:[]}};c(e=>[...e,t])},updateItem:e=>{c(t=>t.map(t=>t.id===e.id?e:t))},placeBid:(e,t,n,l,r)=>{var i;let s=a.find(t=>t.id===e);if(!s||"active"!==s.status||n<s.currentPrice+s.incrementStep)return!1;let d=s.bids.length>0?null==(i=s.bids[s.bids.length-1])?void 0:i.bidderName:null,m=s.roundSettings.enabled?s.roundSettings.currentRound:1,o={id:Date.now().toString(),bidderName:t,amount:n,timestamp:new Date,paymentStatus:"pending",paymentMethod:l||"pending",round:m,bidderInfo:r};return c(t=>t.map(t=>t.id===e?{...t,currentPrice:n,bids:[...t.bids,o]}:t)),d&&d!==t&&N("bidOutbid","竞拍被超越","您对「".concat(s.title,"」的竞拍已被 ").concat(t," 超越，当前价格：\xa5").concat(n),e),!0},setCurrentUser:o,deleteItem:e=>{c(t=>t.filter(t=>t.id!==e))},updatePaymentInfo:e=>{u(e)},getCurrentRound:e=>{let t=a.find(t=>t.id===e);return(null==t?void 0:t.roundSettings.currentRound)||1},getRoundTimeRemaining:e=>{let t=a.find(t=>t.id===e);if(!t||!t.roundSettings.enabled)return 0;let n=new Date,l=t.roundSettings.currentRound-1,r=t.roundSettings.roundEndTimes[l];return r?Math.max(0,r.getTime()-n.getTime()):0},updateNotificationSettings:e=>{x(e)},markNotificationRead:e=>{p(t=>t.map(t=>t.id===e?{...t,read:!0}:t))},clearAllNotifications:()=>{p([])}},children:t})}function m(){let e=(0,l.useContext)(i);if(void 0===e)throw Error("useAuction must be used within an AuctionProvider");return e}},7481:(e,t,a)=>{"use strict";a.d(t,{dj:()=>h});var n=a(2115);let l=0,r=new Map,i=e=>{if(r.has(e))return;let t=setTimeout(()=>{r.delete(e),m({type:"REMOVE_TOAST",toastId:e})},1e6);r.set(e,t)},s=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?i(a):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},d=[],c={toasts:[]};function m(e){c=s(c,e),d.forEach(e=>{e(c)})}function o(e){let{...t}=e,a=(l=(l+1)%Number.MAX_SAFE_INTEGER).toString(),n=()=>m({type:"DISMISS_TOAST",toastId:a});return m({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||n()}}}),{id:a,dismiss:n,update:e=>m({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function h(){let[e,t]=n.useState(c);return n.useEffect(()=>(d.push(t),()=>{let e=d.indexOf(t);e>-1&&d.splice(e,1)}),[e]),{...e,toast:o,dismiss:e=>m({type:"DISMISS_TOAST",toastId:e})}}},8443:(e,t,a)=>{Promise.resolve().then(a.bind(a,4472))},9434:(e,t,a)=>{"use strict";a.d(t,{cn:()=>r});var n=a(2596),l=a(9688);function r(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,l.QP)((0,n.$)(t))}}},e=>{var t=t=>e(e.s=t);e.O(0,[275,70,441,684,358],()=>t(8443)),_N_E=e.O()}]);